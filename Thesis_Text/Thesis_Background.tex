\chapter{Background}
\label{chapter:background}
\section{Option Types}
Before completely focusing on the mechanics of options, what influences their prices and how we can predict their behavior, we should begin by clearly defining the main option types, their characteristics, as well as their payoff functions. Not only will we approach the two main types of options - European and American - but we will also shortly introduce other less common types, commonly referred to as Exotic options, focusing particularly on Barrier options.



\subsection{European Options}
\emph{European options} are the most traded type of option in the OTC market~\cite{InvEuro}. They are not only extremely useful to investors, but also very simple to study and comparatively easy to price. For all these reasons, they have been the subject of much research and are deeply understood. Furthermore, because of their high availability, they are very useful in model calibration and validation.


As stated before, call and put European options enable their buyers to respectively buy and sell the underlying asset \emph{at the maturity} for the fixed strike price.

To understand the payoff function of such contracts, we'll use an example. In the case of a European call option, if at the maturity the market price of its underlying asset is greater than the strike, investors can exercise the option and buy the asset for the fixed lower strike price. They can then immediately go to the market and sell the asset for its higher value. Thus, in this case, the payoff of the option would be the difference between the asset's price and the option's strike price. On the other hand, if at the maturity the price of the asset decreases past the strike, the investor should let the option expire, since the asset is available in the market for a lower price. In this case, the payoff would be zero.
The same reasoning can be made for European put type options, such that the payoff function of both option types can then be deduced as
\begin{equation}\label{callput}
\begin{split}
&\text{Payoff}_{Euro,\ call}(K,T)=\max\left(S(T)-K,0\right);\\
&\text{Payoff}_{Euro,\ put}(K,T)=\max\left(K-S(T),0\right),
\end{split}
\end{equation}
\noindent where $K$ is the option's strike price and $S(T)$ is the asset's price, $S(t)$, at the maturity, $T$. These functions are represented in \autoref{fig:Payoff}.

\begin{figure}[!htb]
    \centering
      \includegraphics[width=.65\columnwidth]{Payoff.eps}
      \caption[Payoff functions of European call and put options]{Payoff functions of European \emph{call} and \emph{put options}.}\label{fig:Payoff}
    \end{figure}
    



\subsection{American Options}
\emph{American options} are more complex than European and thus harder to price. While European options dominate the OTC market, their American counterparts are the most traded type of option in exchanges~\cite{InvAmer}. Because of their great importance, many models have been developed to find the prices of these options~\cite{Longstaff}.

American options grant the right to buy/sell (call/put) the underlying asset at any point in time \emph{until the maturity date}. Following the logic used in the previous example to find the payoff functions of European calls and puts, we can deduce their American counterparts as
\begin{equation}
\begin{split}
&\text{Payoff}_{Amer,\ call}(K,t^*)=\max\left(S(t^*)-K,0\right);\\
&\text{Payoff}_{Amer,\ put}(K,t^*)=\max\left(K-S(t^*),0\right),
\end{split}
\end{equation}
\noindent where we now define $t^*$ (with $0\leq t^*\leq T$) as the exercise date.

It should be obvious that the price of American options will always be greater than or equal to the prices of similar European options. The reason behind this is the fact that with European contracts our exercising decision is restricted to a single day, whereas with American options we have that same day as well as several others to make this choice.


\subsection{Exotic Options}
While European and American options are, by far, the most traded types, \emph{Exotic options} should not be neglected. Not only does there exist a great number of Exotic option types, but these are also highly customizable, making this type of derivatives ideal for unconventional investment strategies. Due to their high complexity, these options are only traded in the OTC market, and not in exchanges~\cite{InvExotic}. We will explore one of the most common types of Exotic options - \emph{Barrier} options - though many others exist.


\subsubsection{Barrier Options}
A \emph{Barrier option} behaves similarly to a European option with the difference that it only becomes active (or becomes worthless) if the value of its underlying asset reaches a particular value, called the \emph{barrier level}, $B$, at any point in time until the option's maturity.

There are four main types of Barrier option:
\begin{itemize}
\item \emph{up-and-out}: the asset's price starts below the barrier (i.e. $S(0)<B$). If it increases past this threshold, the option becomes \emph{worthless};
\item \emph{down-and-out}: the asset's price starts above the barrier (i.e. $S(0)>B$). If it decreases past this threshold, the option becomes \emph{worthless};
\item \emph{up-and-in}: the asset's price starts below the barrier (i.e. $S(0)<B$). \emph{Only if} it increases past this threshold does the option become \emph{active};
\item \emph{down-and-in}: the asset's price starts above the barrier (i.e. $S(0)>B$). \emph{Only if} it decreases past this threshold does the option become \emph{active}.
\end{itemize}

Because all of the previously described Barrier option types are handled similarly, we can easily adapt the models from one type to another. Thus, for simplicity, we will henceforth assume that all Barrier options are of the up-and-in type.

Using the up-and-in Barrier option type as an example, if the asset price, $S(t)$, remains below the barrier level $B$ throughout the whole option duration, even if at the maturity the asset's value is higher than the strike price, the option's payoff would nonetheless be zero. On the contrary, if this threshold was surpassed at any point during this period, the option's payoff would be similar to that of its European equivalent.
The payoff function of this type of option is therefore given by
\begin{equation}\label{barrier}
\begin{split}
&\text{Payoff}_{Barr,\ call}(K,T)=\begin{cases} 
      \max\left(S(T)-K,0\right), & \mathrm{if}\ \ \exists\,t<T\,:\,S(t)>B\\
      0, & \mathrm{otherwise}
   \end{cases};\\
&\text{Payoff}_{Barr,\ put}(K,T)=\begin{cases} 
      \max\left(K-S(T),0\right), & \mathrm{if}\ \ \exists\,t<T\,:\,S(t)>B\\
      0, & \mathrm{otherwise}
   \end{cases}.
\end{split}
\end{equation}


Though Exotic options are used by banks and investors everyday, we will mainly focus on European options: not only are these the most common type of option traded, as we mentioned before, but data is also readily available for many different maturities and strike prices, making European options ideal for model calibration and validation, which will be the main goal of this thesis.
Barrier options will nonetheless be implemented and studied, though no benchmark will be used to verify the models' validity in this case.


\section{Option Prices and Payoffs}
It is important to emphasize the difference between an option's payoff and its profit for investors. Because options grant the right to buy/sell some asset, no investors would exercise an option if this action was disadvantageous to them (i.e. negative payoff value). Thus, the payoff of an option is always positive (it can also, obviously, be zero). This might sound like an arbitrage possibility (i.e. the chance of making profit without risk), but in reality options have a price that investors have to pay in order to acquire them. This means that even if the option's payoff is positive, if this value is lower than the price an investor paid to buy the option, that investor will actually lose money. The profit of an option is thus the difference between its payoff and its price, which can be negative.
With this concept in mind, we can price options by setting their expected profit to be the same as a risk-neutral investment, (e.g. bank deposit). The price of an option can thus be deduced as it's expected future payoff, discounted back to the present
\begin{equation}
\text{Price}(K,t^*)=e^{-rt^*}\mathbb{E}\left[\text{Payoff}(K,t^*)\right],
\end{equation}
\noindent where $t^*$ denotes the time at which the option is exercised and $r$ corresponds to the risk-free interest rate, which we will approach in Section \ref{section:Black-Scholes Formulae}.
In particular, with eqs.\eqref{callput} in mind, the price functions of European call and put options is clearly given by
\begin{equation}\label{callprice}
\begin{split}
&C(K,T)_{Euro}=e^{-rT}\mathbb{E}\left[\max\left(S(T)-K,0\right)\right]=e^{-rT}\mathbb{E}\left[\left(S(T)-K\right)\mathbbm{1}_{\left\{S(T)>K\right\}}\right];\\
&P(K,T)_{Euro}=e^{-rT}\mathbb{E}\left[\max\left(K-S(T),0\right)\right]=e^{-rT}\mathbb{E}\left[\left(K-S(T)\right)\mathbbm{1}_{\left\{S(T)<K\right\}}\right],
\end{split}
\end{equation}
\noindent with $C(K,T)$ and $P(K,T)$ being the values (i.e. prices) of European call and put options, respectively, and $\mathbb{E}[\cdot]$, $\mathbbm{1}_{\{\cdot\}}$ corresponding to the expected value and indicator functions, respectively.

When selling or buying options, investment banks add some premium to this zero-profit price, to account for the risk taken. Though this premium is important to define, it is besides the scope of this work and will not be considered here.
    
\section{Black-Scholes Formulae}
\label{section:Black-Scholes Formulae}
Due to their high importance, options have been studied in great detail in the past.
Probably the most important result in this field came from Fischer Black, Myron Scholes and Robert Merton, who developed a mathematical model to price European options - the famous Black-Scholes (BS) model~\cite{Scholes} - still in use in present days~\cite{Wilmott3}.

This model states that the price of an European call or put option follows the partial differential equation (PDE)

\begin{equation}\label{BS2}
\boxed{\pdv{V}{t}+\frac{1}{2}\sigma^2S^2\pdv{^2V}{S^2}+rS\pdv{V}{S}-rV=0,}
\end{equation}

\noindent where $V$ is the price of the option, $S$ is the price of the underlying (risky) asset, $r$ is the risk-free interest rate and $\sigma$ is the stock price volatility.
The underlying asset is commonly referred to as \emph{stock}, so these terms will be used interchangeably in the following sections.

\begin{proof}
ItÃ´'s Lemma can be applied to our option price $V$, which depends on the (stochastic) stock price $S$ and time $t$, so that we obtain
\begin{equation}\label{BSproof}
dV=\pdv{V}{t}dt+\pdv{V}{S}dS+\frac{1}{2}\pdv{^2V}{S^2} (dS)^2.
\end{equation}

We now assume that the stock price $S$ follows a geometric Brownian Motion,
\begin{equation}\label{BSproofGBM}
dS=rSdt+\sigma SdW,
\end{equation}
\noindent where $W$ is a Brownian motion process.

It can be shown that $(dW)^2=dt$ and $(dt)^2=dt.dW=0$. With these properties in mind, we can substitute eq.\eqref{BSproofGBM} into eq.\eqref{BSproof}, giving
\begin{equation}
\begin{split}
dV=&\pdv{V}{t}dt+\pdv{V}{S}\left(rSdt+\sigma SdW\right)+\frac{1}{2}\sigma^2S^2\pdv{^2V}{S^2}dt\\
=&\left(rS\pdv{V}{S}+\pdv{V}{t}+\frac{1}{2}\sigma^2S^2\pdv{^2V}{S^2}\right)dt+\sigma S\pdv{V}{S}dW.
\end{split}
\end{equation}


We now construct a portfolio where we sell \emph{one} option and buy an amount $\partial V/\partial S$ of stocks. The value of such a portfolio would be
\begin{equation}\label{pi}
\Pi=-V+\pdv{V}{S}S.
\end{equation}

From this equation we can easily derive the change of the portfolio's value, $d\Pi$, in the time interval $dt$ as
\begin{equation}\label{dpi}
\begin{split}
d\Pi&=-dV+\pdv{V}{S}dS\\
&=\left(\pdv{V}{t}+\frac{1}{2}\sigma^2S^2\pdv{^2V}{S^2}\right)dt.
\end{split}
\end{equation}

Because the portfolio's value doesn't change with the Brownian motion $W$, it follows that it is \emph{riskless}.
To avoid any arbitrage possibilities (i.e. making profit without risk, which is usually impossible), the value of this portfolio must be the same as a risk-free asset. The value of a portfolio with such an asset would change with time as
\begin{equation}\label{dpi2}
d\Pi=r\Pi dt.
\end{equation}

Substituting eqs. \eqref{pi} and \eqref{dpi} into eq. \eqref{dpi2} gives
\begin{equation}
\pdv{V}{t}+\frac{1}{2}\sigma^2S^2\pdv{^2V}{S^2}+rS\pdv{V}{S}-rV=0.
\end{equation}

\end{proof}


The risk-free interest rate, $r$, is the interest an investor would receive from any risk-free investment (e.g. treasury bills). No investor should ever invest in risky products whose expected return is lower than this interest (e.g. the lottery), since there's the alternative of obtaining a higher (expected) payoff without the disadvantage of taking risks. In general, this rate changes slightly with time and is unknown, but Black \textit{et al.}, in their original model (eq.\eqref{BS2}), assumed that it remains constant throughout the option's duration and that it is known. Some authors have suggested solutions to deal with this shortcoming, providing models to replicate the behavior of interest rates~\cite{HJM}, but because option prices do not significantly depend on this value~\cite{Wilmott3}, in the remainder of this thesis we shall make the same assumptions as Black \textit{et al.} and set this rate to some constant.

As for the stock price volatility, $\sigma$, since we will explore it to great extent in Chapter \ref{chapter:volatility}, so suffice it to say that it is a measure of the future stock price movement's uncertainty.

Some companies decide to grant their shareholders a part of the profits generated, known as \emph{dividends}. This action decreases the company's total assets, which decreases the value of stocks, changing option prices. Because this occurrence is based on human behavior, it is extremely hard to model. Furthermore, Black \textit{et al.} assumed in their models that no dividends were paid throughout the option's duration. For both these reasons, we will set dividend payment to zero in all our models.


One other important assumption of the BS model is that stock prices follow a stochastic process, known as Geometric Brownian Motion, defined as
\begin{equation}\label{GBM}
dS(t)=rS(t)dt+\sigma S(t)dW(t),
\end{equation}
\noindent with $\{W(t),\ t>0\}$ defining a one-dimensional Brownian motion and where we define $S_0=S(0)$ as the stock price at time $t=0$. An example of such processes is represented in \autoref{fig:GBM}.
\begin{figure}[!htb]
    \centering
      \includegraphics[width=.65\columnwidth]{GBM.eps}
      \caption[Example of Geometric Brownian Motion processes]{Example of three Geometric Brownian Motion processes with maturity $T=\SI{1}{\year}$, interest rate $r=\SI{0.01}{\per\year}$, volatility $\sigma=\SI{0.1}{\year\tothe{-1/2}}$ and initial stock price $S_0=\SI{1}{\EUR}$.}\label{fig:GBM}
    \end{figure}

With this result, pricing options is fairly straightforward - we simply need to solve the PDE in eq.\eqref{BS2} as we would for the diffusion equation's initial value problem~\cite{Dilao}.
The results published originally by Black \textit{et al.} state that, at time $t$, call and put options can be valued as
\begin{equation}\label{callputBS}
\begin{split}
&C=N(d_1)S_0-N(d_2)Ke^{-rT};\\
&P=-N(-d_1)S_0+N(-d_2)Ke^{-rT},
\end{split}
\end{equation}
\noindent where $N(\cdot)$ is the cumulative distribution function of the standard normal distribution and where $d_1$, $d_2$ are given by
\begin{equation}\label{d1d2}
\begin{split}
&d_1=\frac{1}{\sigma\sqrt{T}}\left[\ln\left(\frac{S_0}{K}\right)+\left(r+\frac{\sigma^2}{2}\right)T\right];\\
&d_2=d_1-\sigma\sqrt{T}.\\
\end{split}
\end{equation}
\noindent This is a very important result that can be used to precisely price European options, so long as all the parameters are exactly known (which never occurs).


From eq.\eqref{callputBS} we can also derive the relationship between $C$ and $P$, known as the \emph{put-call parity}
\begin{equation}
C=S_0-Ke^{-rT}+P.
\end{equation}
\noindent Because of this duality, we can always easily obtain the prices of put options from the prices of call options with the same underlying asset, maturity and strike. For this reason, some of the results presented in later sections only apply to call options, though we can just as easily find their put option equivalent.


Finally, we can obtain a lower bound for the prices of European call and put options. Using some non-arbitrage arguments it can be shown that
\begin{equation}\label{bound}
\begin{split}
C&\geq \max\left[S_0-Ke^{-rT}\right];\\
P&\geq \max\left[Ke^{-rT}-S_0\right].
\end{split}
\end{equation}