(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     36468,        917]
NotebookOptionsPosition[     35288,        877]
NotebookOutlinePosition[     35635,        892]
CellTagsIndexPosition[     35592,        889]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Clear", " ", "all", " ", "prevous", " ", "variables", " ", "to", " ", 
    "avoid", " ", "errors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NotebookSave", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.7142450096927867`*^9, 3.7142450096927867`*^9}, {
  3.714248961487697*^9, 3.7142489620035844`*^9}, {3.7203656646495185`*^9, 
  3.7203656777157187`*^9}}],

Cell[TextData[StyleBox["Initial Parameters",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.715950918627969*^9, 3.7159509386986337`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "50"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "exercise", " ", "points", " ", "per", " ", 
    "year"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "1"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "years", " ", "in", " ", "the", " ", 
     "contract"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"R", "=", "0.06"}], ";", 
   RowBox[{"(*", 
    RowBox[{"Yearly", " ", "discount", " ", "factor"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"r", "=", 
    RowBox[{"R", "/", "n"}]}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"R", "/", "n"}], " ", "=", " ", 
     RowBox[{
     "Discount", " ", "factor", " ", "per", " ", "unit", " ", "time"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"sigma", "=", "0.2"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "Volatility", " ", "of", " ", "the", " ", "underlying", " ", "stock", " ",
      "price"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"S0", "=", "45."}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Initial", " ", "stock", " ", "price"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", "25000"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "simulated", " ", "stock", " ", "price", " ", 
    "paths"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"callput", "=", "\"\<Put\>\""}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"option", " ", "type"}], " ", "-", " ", 
    RowBox[{"\"\<Put\>\"", " ", "or", " ", "\"\<Call\>\""}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"K", "=", "40."}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Strike", " ", "Price"}], "*)"}], 
  "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.714633810099053*^9, 3.714634159610441*^9}, {
   3.7146350876217494`*^9, 3.714635180968044*^9}, {3.7146357956422753`*^9, 
   3.714635988921262*^9}, 3.714636668246379*^9, {3.7146368074995728`*^9, 
   3.7146368345656166`*^9}, 3.7146371214332657`*^9, {3.714637951347069*^9, 
   3.7146379530971727`*^9}, {3.7146383913319454`*^9, 3.714638476605561*^9}, 
   3.7146399513079057`*^9, {3.7146437886956825`*^9, 3.714643904096194*^9}, {
   3.714645250148823*^9, 3.714645286381131*^9}, {3.715949898862425*^9, 
   3.7159498990592065`*^9}, {3.7159500233359084`*^9, 3.715950113569524*^9}, {
   3.7159502582523785`*^9, 3.715950258600306*^9}, {3.715950656569542*^9, 
   3.715950942550347*^9}, {3.7159510543698683`*^9, 3.7159510722530656`*^9}, 
   3.717772162758077*^9, {3.71777371659631*^9, 3.717773774291851*^9}, {
   3.7177746285735188`*^9, 3.7177748077721443`*^9}, {3.7177749385126033`*^9, 
   3.717775060307947*^9}, {3.717775216793667*^9, 3.7177752193173532`*^9}, {
   3.717775324499693*^9, 3.717775328966193*^9}, {3.7177754826216054`*^9, 
   3.717775517870154*^9}, {3.717775785875349*^9, 3.7177758062598763`*^9}, {
   3.71777594475628*^9, 3.717775947437808*^9}, 3.7177763404200563`*^9, {
   3.717776482701666*^9, 3.7177766065646477`*^9}, {3.717781124046506*^9, 
   3.717781209276846*^9}, {3.717781796410817*^9, 3.717781796555623*^9}, {
   3.717784533474285*^9, 3.717784534270223*^9}, {3.718891160788903*^9, 
   3.718891162812154*^9}, {3.71889197306433*^9, 3.7188919732174635`*^9}, {
   3.718892103545701*^9, 3.71889210363058*^9}, {3.718892865076048*^9, 
   3.7188928652433257`*^9}, {3.718894422820673*^9, 3.7188944231380525`*^9}, {
   3.7188950010603294`*^9, 3.718895078532223*^9}, {3.7188956949779615`*^9, 
   3.718895978955085*^9}, {3.720365686335232*^9, 3.7203657193795414`*^9}, {
   3.7203663328265533`*^9, 3.7203663329816694`*^9}, 3.7203664130519347`*^9, {
   3.72052261153825*^9, 3.7205226150697527`*^9}, {3.72052334440322*^9, 
   3.7205233453718143`*^9}, {3.720523860505273*^9, 3.720523906711841*^9}, {
   3.720524135692911*^9, 3.7205242047793827`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "If", " ", "you", " ", "want", " ", "to", " ", "replicate", " ", "the", 
      " ", "first", " ", "example", " ", "on", " ", "Longstaff"}], "-", 
     RowBox[{
      RowBox[{"Schwartz", "'"}], "s", " ", "article"}]}], ",", " ", 
    RowBox[{"uncomment", " ", "the", " ", "following", " ", "lines"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.", ",", "1.09", ",", "1.08", ",", "1.34"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "1.16", ",", "1.26", ",", "1.54"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "1.22", ",", "1.07", ",", "1.03"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "0.93", ",", "0.97", ",", "0.92"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "1.11", ",", "1.56", ",", "1.52"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", ".76", ",", ".77", ",", ".90"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", ".92", ",", ".84", ",", "1.01"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", ".88", ",", "1.22", ",", "1.34"}], "}"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"n", "=", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Number", " ", "of", " ", "exercise", " ", "points", " ", "per", " ", 
      "year"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"T", "=", "3"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Number", " ", "of", " ", "years", " ", "in", " ", "the", " ", 
      "contract"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"R", "=", "0.06"}], ";", 
    RowBox[{"(*", 
     RowBox[{"Year", " ", "discount", " ", "factor"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"r", "=", 
     RowBox[{"R", "/", "n"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Discount", " ", "factor", " ", "per", " ", "unit", " ", "time"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"S0", "=", "1."}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Initial", " ", "price", " ", "of", " ", "the", " ", "option"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"M", "=", "8"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Number", " ", "of", " ", "simulated", " ", "paths"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"callput", "=", "\"\<Put\>\""}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"option", " ", 
      RowBox[{"type", ":", " ", 
       RowBox[{"\"\<Put\>\"", " ", "or", " ", "\"\<Call\>\""}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"K", "=", "1.1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Strike", " ", "Price"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"regr", "[", "x_", "]"}], "=", 
     RowBox[{"Fit", "[", 
      RowBox[{"reg", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "x", ",", 
         RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}]}], ";"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7203657231511354`*^9, 3.720365773518503*^9}}],

Cell[TextData[StyleBox["Path Simulation",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{3.7159508621838884`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dT", "=", 
    RowBox[{"1", "/", "n"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Time", " ", "step", " ", "duration"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", "M", ",", 
      RowBox[{
       RowBox[{"n", "*", "T"}], "+", "1"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Table", " ", "with", " ", "all", " ", "the", " ", "simulated", " ", 
    RowBox[{"paths", ".", " ", "All"}], " ", "entries", " ", "are", " ", 
    "initially", " ", "assigned", " ", "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", "S0"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Set", " ", "all", " ", 
    RowBox[{"paths", "'"}], " ", "starting", " ", "points", " ", "to", " ", 
    "the", " ", "initial", " ", "stock", " ", "price"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dW", "=", 
    RowBox[{
     RowBox[{"Sqrt", "[", "dT", "]"}], "*", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", 
         RowBox[{"n", "*", "T"}]}], "}"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Matrix", " ", "with", " ", "the", " ", "normally", " ", "distributed", 
    " ", "random", " ", "variables", " ", "to", " ", "be", " ", "used", " ", 
    "in", " ", "the", " ", "geometric", " ", "Brownian", " ", "motion"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"n", "*", "T"}]}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}], "+", 
      RowBox[{"R", "*", "dT", "*", 
       RowBox[{"S", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "+", 
      RowBox[{"sigma", "*", 
       RowBox[{"S", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "i"}], "]"}], "]"}], "*", 
       RowBox[{"dW", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "i"}], "]"}], "]"}]}]}]}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Simulate", " ", "geometric", " ", "Brownian", " ", 
     RowBox[{"Motion", ":", " ", "dS"}]}], "=", 
    RowBox[{
     RowBox[{"r", "*", "S", "*", "dt"}], "+", 
     RowBox[{"\[Sigma]", "*", "S", "*", "dW"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7159508811719675`*^9, 3.7159513621283975`*^9}, {
  3.7177766337199244`*^9, 3.7177767035615034`*^9}, {3.717781162902791*^9, 
  3.717781163480855*^9}, {3.7177837354625587`*^9, 3.717783752138893*^9}, {
  3.720365819326024*^9, 3.7203658200991144`*^9}, {3.720366619209197*^9, 
  3.7203666650082855`*^9}}],

Cell[TextData[StyleBox["Longstaff-Schwartz Algorithm",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.7146365878087935`*^9, 3.7146366047383995`*^9}, {
  3.720366601148327*^9, 3.72036660320598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"callput", "==", "\"\<Put\>\""}], ",", 
    RowBox[{
     RowBox[{"Payoff", "[", "stock_", "]"}], ":=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"K", "-", "stock"}], ",", "0"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"Payoff", "[", "stock_", "]"}], ":=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"stock", "-", "K"}], ",", "0"}], "]"}]}]}], "]"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Return", " ", 
    RowBox[{"Put", "/", "Call"}], " ", "payoff", " ", "functions"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.714244739223222*^9, 3.7142450465156193`*^9}, {
  3.7159513737919693`*^9, 3.715951429345128*^9}, {3.720365987511088*^9, 
  3.7203659877372975`*^9}, {3.7205243512655163`*^9, 3.720524360096753*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cfdisc", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", "M", ",", 
      RowBox[{"n", "*", "T"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Matrix", " ", "with", " ", "all", " ", "discounted", " ", "cash", " ", 
    "flows"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cfdisc", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"n", "*", "T"}]}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Payoff", ",", 
       RowBox[{"S", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"n", "*", "T"}], "+", "1"}]}], "]"}], "]"}]}], "]"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "R"}], "*", "T"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Set", " ", "the", " ", "final", " ", "cash", " ", "flow", " ", 
    RowBox[{"matrix", "'"}], " ", "final", " ", "entry", " ", "to", " ", 
    "the", " ", "discounted", " ", "cash", " ", "flows", " ", "at", " ", 
    "the", " ", "maturity"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7142454678957696`*^9, 3.7142455910412197`*^9}, {
  3.714247070004899*^9, 3.714247095451836*^9}, {3.714248762383377*^9, 
  3.714248793503133*^9}, {3.7143341266732607`*^9, 3.7143341270794744`*^9}, {
  3.714334650788845*^9, 3.714334655322508*^9}, {3.714334940317916*^9, 
  3.7143349415524216`*^9}, {3.7144184763860884`*^9, 3.7144185916218424`*^9}, {
  3.7144187461581345`*^9, 3.7144187645102577`*^9}, {3.7146318645741873`*^9, 
  3.7146318679424767`*^9}, {3.714638258256488*^9, 3.7146383369580193`*^9}, {
  3.714643716887657*^9, 3.714643717871665*^9}, {3.715951525356781*^9, 
  3.7159515282335625`*^9}, {3.7159519268457375`*^9, 3.715951931966323*^9}, {
  3.715952239575263*^9, 3.715952311902956*^9}, {3.7177753598220873`*^9, 
  3.717775409561881*^9}, {3.717775777595194*^9, 3.7177758824345007`*^9}, {
  3.71778126693445*^9, 3.717781271516469*^9}, {3.7203660045091906`*^9, 
  3.720366035538701*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"euro", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"cfdisc", ",", "2"}], "]"}], "/", "M"}]}], "  ", 
  RowBox[{"(*", 
   RowBox[{"European", " ", "option", " ", "price"}], "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.7178510716258097`*^9, 3.7178511175103464`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cfreal", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", "M", ",", 
      RowBox[{"n", "*", "T"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Matrix", " ", "with", " ", 
    RowBox[{"all", " ", "[", 
     RowBox[{"not", "-", "discounted"}], "]"}], " ", "cash", " ", "flows"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cfreal", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"n", "*", "T"}]}], "]"}], "]"}], "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Payoff", ",", 
      RowBox[{"S", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"n", "*", "T"}], "+", "1"}]}], "]"}], "]"}]}], "]"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "cash", " ", "flows", " ", "at", " ", "the", " ", 
    "maturity"}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7146320727479753`*^9, 3.714632094007389*^9}, {
  3.714638258256488*^9, 3.7146383369736423`*^9}, {3.715952280192052*^9, 
  3.7159523884352407`*^9}, {3.7177753635481167`*^9, 3.7177754205835733`*^9}, {
  3.717775868807031*^9, 3.717775877263424*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sr", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", "M", ",", 
      RowBox[{"n", "*", "T"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Matrix", " ", "with", " ", "all", " ", "recommended", " ", "exercice", 
    " ", 
    RowBox[{"decisions", ".", " ", "Entry"}], " ", "1", " ", "if", " ", 
    "exercise", " ", "is", " ", "recommended", " ", "at", " ", "the", " ", 
    "respective", " ", "period", " ", "and", " ", "0", " ", "otherwise"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sr", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"n", "*", "T"}]}], "]"}], "]"}], "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Sign", ",", 
      RowBox[{"cfdisc", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"n", "*", "T"}]}], "]"}], "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Obtain", " ", "all", " ", "recommended", " ", "exercise", " ", 
    "decisions", " ", "at", " ", "the", " ", "maturity"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7142455797634926`*^9, 3.7142455886020803`*^9}, {
   3.7142471173501167`*^9, 3.714247123337398*^9}, {3.714247964443629*^9, 
   3.7142479725933533`*^9}, {3.714334137113951*^9, 3.714334137239047*^9}, {
   3.7143349509431005`*^9, 3.7143349512086782`*^9}, 3.7143352714289675`*^9, {
   3.7143357735542393`*^9, 3.71433588231192*^9}, {3.7144185393061*^9, 
   3.7144186057911463`*^9}, 3.71463187098964*^9, {3.714638258256488*^9, 
   3.7146383369736423`*^9}, {3.715952395409326*^9, 3.7159524968885593`*^9}, {
   3.717775366696762*^9, 3.7177754460770516`*^9}, {3.717775889803543*^9, 
   3.7177758976727467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lastsr", "[", "path_", "]"}], ":=", 
    RowBox[{
     RowBox[{"FirstPosition", "[", 
      RowBox[{
       RowBox[{"cfdisc", "[", 
        RowBox[{"[", "path", "]"}], "]"}], ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[NotEqual]", "0"}], "&"}], ")"}]}], ",", 
       RowBox[{"{", "0", "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Auxiliary", " ", "function", " ", "to", " ", "find", " ", "the", " ", 
    "recommended", " ", "exercise", " ", "point", " ", "for", " ", "a", " ", 
    "given", " ", 
    RowBox[{"path", ".", " ", "Finds"}], " ", "the", " ", "index", " ", "on", 
    " ", "matrix", " ", "cfdisc", " ", "where", " ", "the", " ", "entry", " ",
     "is", " ", "different", " ", "from", " ", "0"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7159525546491165`*^9, 3.715952564366675*^9}, {
   3.7159543547451563`*^9, 3.715954384718213*^9}, 3.7188902522433796`*^9, {
   3.720366098239046*^9, 3.7203661441080008`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"discpayoff", "[", 
     RowBox[{"path_", ",", "current_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"lastsr", "[", "path", "]"}], "\[NotEqual]", "0"}], ",", 
      RowBox[{
       RowBox[{"cfreal", "[", 
        RowBox[{"[", 
         RowBox[{"path", ",", 
          RowBox[{"lastsr", "[", "path", "]"}]}], "]"}], "]"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "r"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lastsr", "[", "path", "]"}], "-", "current"}], ")"}]}], 
        "]"}]}], ",", "0"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Auxiliary", " ", "function", " ", "that", " ", "returns", " ", "the", 
     " ", "discounted", " ", "cash", " ", "flow", " ", "between", " ", "the", 
     " ", "last", " ", "recommended", " ", "exercise", " ", "time", " ", 
     "and", " ", "the", " ", "\"\<current time\>\""}], ",", " ", 
    RowBox[{
    "that", " ", "we", " ", "are", " ", "trying", " ", "to", " ", "check", 
     " ", "if", " ", "is", " ", "optimal"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.715954397106764*^9, 3.7159545026939316`*^9}, 
   3.7177727855375032`*^9, {3.7177733079683075`*^9, 3.7177733147021685`*^9}, {
   3.7177734441564302`*^9, 3.7177734444747305`*^9}, {3.717773675446393*^9, 
   3.7177736800533094`*^9}, {3.7177738331403036`*^9, 
   3.7177738337426424`*^9}, {3.7177744887819443`*^9, 3.71777449321572*^9}, {
   3.7177751742813735`*^9, 3.7177751757193956`*^9}, 3.717775541601118*^9, {
   3.7177839674218054`*^9, 3.7177839675365553`*^9}, {3.7177844360251584`*^9, 
   3.7177844362502565`*^9}, 3.7188902936757293`*^9, {3.718890875642355*^9, 
   3.718890876081369*^9}, {3.7188951018968325`*^9, 3.7188951807123117`*^9}, {
   3.718895670367385*^9, 3.71889568235979*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", 
      RowBox[{
       RowBox[{"n", "*", "T"}], "-", "1"}]}], ",", 
     RowBox[{"j", "\[GreaterEqual]", "1"}], ",", 
     RowBox[{"j", "--"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reg", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Matrix", " ", "with", " ", "all", " ", "the", " ", "current", " ", 
         "in"}], "-", "the", "-", 
        RowBox[{
        "money", " ", "stock", " ", "prices", " ", "that", " ", "will", " ", 
         "be", " ", "used", " ", "to", " ", "fit", " ", "the", " ", "least", 
         " ", "squares", " ", "functions"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "M"}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Payoff", "[", 
            RowBox[{"S", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "]"}], ">", "0"}], 
          ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"reg", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "1"}]}], "]"}], "]"}], ",", 
              RowBox[{"discpayoff", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}], ","}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Find", " ", "all", " ", "the", " ", "in"}], "-", "the", "-", 
         RowBox[{
         "money", " ", "stock", " ", "prices", " ", "and", " ", "the", " ", 
          "discounted", " ", "payoff", " ", "from", " ", 
          RowBox[{"continuation", ".", " ", "If"}], " ", "it", " ", "is", " ",
           "optimal", " ", "to", " ", "exercise"}]}], ",", " ", 
        RowBox[{
        "append", " ", "the", " ", "stock", " ", "price", " ", "to", " ", 
         "the", " ", "matrix", " ", 
         RowBox[{"reg", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vals", "=", 
       RowBox[{"FindFit", "[", 
        RowBox[{"reg", ",", 
         RowBox[{"a", "+", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "x"}], "/", "2"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"b", "+", "c", "+", "d", "+", "e"}], ")"}], "-", 
             RowBox[{"x", "*", 
              RowBox[{"(", 
               RowBox[{"c", "+", 
                RowBox[{"2", "d"}], "+", 
                RowBox[{"3", "e"}]}], ")"}]}], "+", 
             RowBox[{"0.5", "*", 
              RowBox[{"x", "^", "2"}], "*", 
              RowBox[{"(", 
               RowBox[{"d", "+", 
                RowBox[{"3", "*", "e"}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"1", "/", "6"}], "*", 
              RowBox[{"x", "^", "3"}], "*", "e"}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "}"}], ",", 
         "x"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"regr", "[", "x_", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "/.", "vals"}], ")"}], "+", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "x"}], "/", "2"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"b", "/.", "vals"}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{"c", "/.", "vals"}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{"d", "/.", "vals"}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{"e", "/.", "vals"}], ")"}]}], ")"}], "-", 
           RowBox[{"x", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"c", "/.", "vals"}], ")"}], "+", 
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{"d", "/.", "vals"}], ")"}]}], "+", 
              RowBox[{"3", 
               RowBox[{"(", 
                RowBox[{"e", "/.", "vals"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"0.5", "*", 
            RowBox[{"x", "^", "2"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d", "/.", "vals"}], ")"}], "+", 
              RowBox[{"3", "*", 
               RowBox[{"(", 
                RowBox[{"e", "/.", "vals"}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "6"}], "*", 
            RowBox[{"x", "^", "3"}], "*", 
            RowBox[{"(", 
             RowBox[{"e", "/.", "vals"}], ")"}]}]}], ")"}]}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Fit", " ", "the", " ", "data", " ", "to", " ", "a", " ", "set", " ", 
        "of", " ", "functions", " ", "using", " ", "least", " ", "squares"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "M"}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Payoff", "[", 
            RowBox[{"S", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "]"}], ">", "0"}], 
          ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Payoff", "[", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "]"}], ">=", 
             RowBox[{"regr", "[", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "]"}]}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "if", " ", "it", " ", "is", " ", "recommended", " ", "to", " ", 
               "exercise", " ", "at", " ", "the", " ", "current", " ", 
               "time"}], ",", " ", 
              RowBox[{"update", " ", "the", " ", "cash", " ", "flow", " ", 
               RowBox[{"tables", ".", " ", "Otherwise"}]}], ",", " ", 
              RowBox[{"do", " ", "nothing"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"cfdisc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"cfreal", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sr", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}], "=", "0"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"cfdisc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"Payoff", "[", 
                RowBox[{"S", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "]"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "r"}], "*", "j"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"cfreal", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"Payoff", "[", 
               RowBox[{"S", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"sr", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "1"}]}], ","}], 
           "]"}], ","}], "]"}]}], "]"}]}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.714334797458578*^9, 3.714334873837798*^9}, {
   3.7143349888090343`*^9, 3.714334990591894*^9}, {3.71433592452324*^9, 
   3.7143362718329215`*^9}, {3.7143364689750853`*^9, 
   3.7143366282193575`*^9}, {3.714416376821703*^9, 3.7144165151376195`*^9}, {
   3.7144168527284465`*^9, 3.714416942214102*^9}, 3.7144179575331955`*^9, {
   3.714418296587495*^9, 3.7144183910219193`*^9}, {3.7144184905829725`*^9, 
   3.7144185045848813`*^9}, {3.7144186438041325`*^9, 3.714418726143981*^9}, {
   3.714631779503096*^9, 3.714631892485116*^9}, {3.7146321148766108`*^9, 
   3.714632140499099*^9}, 3.71463794762645*^9, 3.7146381160002265`*^9, {
   3.71463825827357*^9, 3.7146383369736423`*^9}, {3.7146437418157716`*^9, 
   3.714643742792081*^9}, {3.7159545066389856`*^9, 3.715954712404604*^9}, {
   3.7177736712452383`*^9, 3.7177736713818874`*^9}, 3.7177739630245657`*^9, {
   3.7177750749139767`*^9, 3.7177751315070405`*^9}, {3.7177755707052402`*^9, 
   3.717775600978215*^9}, {3.717776024655758*^9, 3.7177760250649147`*^9}, {
   3.717776265390383*^9, 3.717776265845255*^9}, 3.7177787821752977`*^9, {
   3.717778923800925*^9, 3.717778926571329*^9}, {3.717781328735324*^9, 
   3.717781329181611*^9}, 3.7177843325700655`*^9, 3.7188903961722183`*^9, {
   3.7188914358767843`*^9, 3.718891492558058*^9}, 3.7188916967082443`*^9, {
   3.718891969705109*^9, 3.718892182235886*^9}, {3.7188952474334574`*^9, 
   3.718895291236827*^9}, {3.718895603694867*^9, 3.718895771345049*^9}, {
   3.7203659216104126`*^9, 3.72036596243883*^9}, {3.7203661751934433`*^9, 
   3.7203663066120806`*^9}, {3.7205228761721277`*^9, 3.720522879563224*^9}, {
   3.720524244196601*^9, 3.720524246593711*^9}, 3.7205243674334717`*^9, {
   3.720524611970066*^9, 3.7205246296383696`*^9}, 3.7205264219988327`*^9, {
   3.7205272721163373`*^9, 3.720527527684705*^9}, {3.7205279033513794`*^9, 
   3.7205279544541593`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"19.351936569574985`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.7205228846691513`*^9, 3.720522970720728*^9}, 
   3.720523313741121*^9, 3.720523678191607*^9, 3.7205239191781483`*^9, {
   3.7205241611131268`*^9, 3.720524391243059*^9}, 3.720524536673094*^9, 
   3.720524841734148*^9, {3.720526477494979*^9, 3.720526501869155*^9}, {
   3.7205272270489435`*^9, 3.720527346396017*^9}, 3.7205279790140257`*^9, {
   3.7205281061235623`*^9, 3.720528143169324*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["Final Result",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.7159547583250694`*^9, 3.7159547636552277`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "r"}], "*", 
          RowBox[{"First", "[", "#2", "]"}]}], "]"}]}], "&"}], ",", 
      RowBox[{"Transpose", "[", "cfreal", "]"}]}], "]"}], ",", "2"}], "]"}], 
  "/", "M", " ", 
  RowBox[{"(*", 
   RowBox[{"American", " ", "option", " ", "price"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.718892663453712*^9, 3.7188928864692745`*^9}, {
  3.7188938767191167`*^9, 3.718893965652669*^9}, {3.7188940752506237`*^9, 
  3.7188941073387995`*^9}, {3.7188942484182835`*^9, 3.718894409859806*^9}, {
  3.7203663166862755`*^9, 3.7203663231199923`*^9}, {3.7205265075035753`*^9, 
  3.7205265167565465`*^9}, {3.72052720041656*^9, 3.720527204486601*^9}, {
  3.720527535444462*^9, 3.7205275377284737`*^9}}],

Cell[BoxData["0.9282900249735135`"], "Output",
 CellChangeTimes->{
  3.7188927047189612`*^9, {3.718892850005707*^9, 3.7188929223038206`*^9}, {
   3.7188938820934467`*^9, 3.718893966962386*^9}, {3.7188940767020493`*^9, 
   3.718894108735941*^9}, {3.718894251794404*^9, 3.7188944103343177`*^9}, 
   3.7188946094973993`*^9, {3.7188950741013503`*^9, 3.7188953021652794`*^9}, {
   3.7188956373025055`*^9, 3.718895676007324*^9}, 3.7188959654367905`*^9, 
   3.7188961625227585`*^9, 3.720366432644548*^9, 3.7205227076316786`*^9, 
   3.720522971275272*^9, 3.720523314260517*^9, 3.7205236786969633`*^9, 
   3.7205239193325663`*^9, {3.720524161393881*^9, 3.720524391476691*^9}, 
   3.7205248419708157`*^9, {3.720526477739691*^9, 3.7205265145583935`*^9}, {
   3.7205272272863083`*^9, 3.720527346673795*^9}, 3.7205279792714796`*^9, {
   3.7205281064078503`*^9, 3.720528143419036*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"euro", " ", 
  RowBox[{"(*", 
   RowBox[{"European", " ", "option", " ", "price", " ", 
    RowBox[{"(", 
     RowBox[{"see", " ", "above"}], ")"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7178511136726956`*^9, 3.717851113888836*^9}, {
  3.7203660483148603`*^9, 3.7203660512760715`*^9}}],

Cell[BoxData["0.8480598829071452`"], "Output",
 CellChangeTimes->{
  3.7178511401925135`*^9, 3.7188910951578836`*^9, 3.7188913446337423`*^9, 
   3.7188916330023856`*^9, {3.7188919434237723`*^9, 3.7188920517597733`*^9}, 
   3.718892172421601*^9, 3.7188929224075966`*^9, 3.7188939226277337`*^9, 
   3.7188946098052015`*^9, {3.718895074128661*^9, 3.7188953021878395`*^9}, {
   3.718895637321056*^9, 3.7188956760258465`*^9}, 3.7188959654453382`*^9, 
   3.7188961625463204`*^9, 3.7203664326606236`*^9, 3.720522707642708*^9, 
   3.720522971286274*^9, 3.720523314268526*^9, 3.7205236787049847`*^9, 
   3.7205239193405867`*^9, {3.7205241614044104`*^9, 3.7205243914847107`*^9}, 
   3.720524841978835*^9, {3.7205264777487144`*^9, 3.7205265021199636`*^9}, {
   3.720527227297339*^9, 3.7205273466828184`*^9}, 3.7205279792845135`*^9, {
   3.7205281064193816`*^9, 3.7205281434270563`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"]
},
WindowSize->{1424, 817},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 474, 10, 50, "Input"],
Cell[1035, 32, 251, 6, 43, "Text"],
Cell[1289, 40, 3855, 79, 202, "Input"],
Cell[5147, 121, 3115, 79, 221, "Input"],
Cell[8265, 202, 224, 6, 43, "Text"],
Cell[8492, 210, 3097, 87, 126, "Input"],
Cell[11592, 299, 311, 7, 43, "Text"],
Cell[11906, 308, 816, 21, 30, "Input"],
Cell[12725, 331, 2051, 46, 69, "Input"],
Cell[14779, 379, 315, 8, 30, "Input"],
Cell[15097, 389, 1201, 34, 69, "Input"],
Cell[16301, 425, 1742, 41, 69, "Input"],
Cell[18046, 468, 1101, 26, 50, "Input"],
Cell[19150, 496, 1876, 41, 69, "Input"],
Cell[CellGroupData[{
Cell[21051, 541, 10347, 246, 335, "Input"],
Cell[31401, 789, 508, 8, 30, "Output"]
}, Open  ]],
Cell[31924, 800, 247, 6, 43, "Text"],
Cell[CellGroupData[{
Cell[32196, 810, 909, 21, 30, "Input"],
Cell[33108, 833, 871, 12, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34016, 850, 315, 7, 30, "Input"],
Cell[34334, 859, 875, 12, 30, "Output"]
}, Open  ]],
Cell[35224, 874, 60, 1, 30, "Input"]
}
]
*)

