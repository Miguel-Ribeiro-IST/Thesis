(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46846,       1204]
NotebookOptionsPosition[     45236,       1149]
NotebookOutlinePosition[     45577,       1164]
CellTagsIndexPosition[     45534,       1161]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "clear", " ", "all", " ", "variables", " ", "to", " ", "avoid", " ", 
    "errors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NotebookSave", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"DateList", "[", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "Hour", " ", "when", " ", "the", " ", "computation", " ", "started"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Get", "[", 
    "\"\<C:\\\\Users\\\\Miguel \
Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\\Functions\\\\Function.m\>\"", 
    "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "get", " ", "function", " ", "\"\<Simul\>\"", " ", "written", " ", "on", 
     " ", "file", " ", 
     RowBox[{"Function", ".", "nb", ".", " ", "This"}], " ", "function", " ", 
     "does", " ", "exactly", " ", "the", " ", "same", " ", "as", " ", "the", 
     " ", "whole", " ", "file", " ", 
     RowBox[{"Simulation", ".", "nb"}]}], ",", " ", 
    RowBox[{
    "only", " ", "it", " ", "does", " ", "it", " ", "as", " ", "a", " ", 
     "single", " ", "function", " ", "with", " ", "a", " ", "single", " ", 
     "return", " ", "that", " ", "corresponds", " ", "to", " ", "the", " ", 
     "option", " ", 
     RowBox[{"price", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "expects", " ", "the", " ", "inputs"}], " ",
     "-", " ", 
    RowBox[{
     RowBox[{"Simul", "[", 
      RowBox[{
      "M", ",", "callput", ",", "n", ",", "T", ",", "K", ",", "r", ",", 
       "sigma", ",", "S0"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"see", " ", "below"}], ")"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7142450096927867`*^9, 3.7142450096927867`*^9}, {
   3.714248961487697*^9, 3.7142489620035844`*^9}, {3.7167307321716595`*^9, 
   3.7167307326058245`*^9}, 3.716730889167138*^9, {3.7185324613959336`*^9, 
   3.7185324685044785`*^9}, 3.718797026817216*^9, {3.7203616367826385`*^9, 
   3.7203616428564835`*^9}, {3.7203621708863173`*^9, 
   3.7203623242472525`*^9}, {3.7203634367724233`*^9, 
   3.7203634742877026`*^9}, {3.7203637278825636`*^9, 3.7203637444299145`*^9}, 
   3.720364279496499*^9, {3.720364468368374*^9, 3.7203644916008663`*^9}, {
   3.7203654462960663`*^9, 3.7203654478707604`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"19", ",", "34", ",", "58.2028421`9.51751902314252"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7203642699159265`*^9, 3.7203643015950007`*^9}, 
   3.7203644482181*^9, {3.7203644924412923`*^9, 3.720364498218468*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["Distribution Parameters",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.7167305839751053`*^9, 3.716730589395534*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "we", " ", "assume", " ", "the", " ", "variables", " ", "for", " ", "the",
      " ", "interest", " ", "rate", " ", 
     RowBox[{"(", "r", ")"}]}], ",", " ", 
    RowBox[{"stock", " ", "price", " ", "volatility", " ", 
     RowBox[{"(", "\[Sigma]", ")"}], " ", "and", " ", "initial", " ", "stock",
      " ", "price", " ", 
     RowBox[{"(", "S0", ")"}], " ", "follow", " ", "a", " ", "normal", " ", 
     RowBox[{"distribution", ".", " ", "This"}], " ", "particular", " ", 
     "choice", " ", "of", " ", "variables", " ", "was", " ", 
     RowBox[{"arbitrary", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "output", " ", "of", " ", "the", " ", 
     "sensitivity", " ", "analysis"}], ",", " ", "Vi", ",", " ", 
    RowBox[{"for", " ", "each", " ", "of", " ", "these", " ", "variables"}], 
    ",", " ", 
    RowBox[{
    "will", " ", "indicate", " ", "what", " ", "fraction", " ", "of", " ", 
     "price", " ", "variance", " ", "is", " ", "generated", " ", "by", " ", 
     "the", " ", "individual", " ", "variance", " ", "of", " ", "the", " ", 
     "respective", " ", 
     RowBox[{"input", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rm", "=", "0.06"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"interest", " ", "rate", " ", "expected", " ", "value"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rs", "=", "0.001"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"interest", " ", "rate", " ", "standard", " ", "deviation"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigmam", "=", "0.2"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "stock", " ", "price", " ", "volatility", " ", "expected", " ", "value"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigmas", "=", "0.01"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "stock", " ", "price", " ", "volatility", " ", "standard", " ", 
     "deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S0m", "=", "44."}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "initial", " ", "stock", " ", "price", " ", "expected", " ", "value"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S0s", "=", ".1"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "initial", " ", "stock", " ", "price", " ", "standard", " ", 
     "deviation"}], "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.716730613077941*^9, 3.7167307190395746`*^9}, {
   3.7167313734510574`*^9, 3.716731373575374*^9}, {3.7185316704376893`*^9, 
   3.7185317221496215`*^9}, {3.7188962818556414`*^9, 3.718896325890917*^9}, 
   3.718896470126851*^9, {3.720362333185568*^9, 3.720362334336073*^9}, {
   3.7203623781297846`*^9, 3.720362651479578*^9}, {3.720362693746348*^9, 
   3.7203629375533166`*^9}}],

Cell[TextData[StyleBox["Set Parameters",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.716731237908811*^9, 3.716731259015463*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Num", "=", "500"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Number", " ", "of", " ", "simulations", " ", "per", " ", "vector"}], " ",
     "-", " ", 
    RowBox[{
    "See", " ", "the", " ", "article", " ", "by", " ", "Sobol", " ", "for", 
     " ", "more", " ", "information"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", "=", "50000"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "paths", " ", "to", " ", "be", " ", "generated", 
    " ", "on", " ", "each", " ", "simulation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"callput", "=", "\"\<Put\>\""}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Type", " ", "of", " ", "option"}], " ", "-", " ", 
    RowBox[{"\"\<Call\>\"", " ", "or", " ", "\"\<Put\>\""}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "12."}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "exercise", " ", "chances", " ", "per", " ", 
    "year"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "1."}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "years", " ", "until", " ", "exercise"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "40."}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Strike", " ", "price"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Exporting", "=", "False"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Choose", " ", "True", " ", "if", " ", "you", " ", "want", " ", "the", 
     " ", "final", " ", "matrices", " ", "and", " ", "images", " ", "to", " ",
      "be", " ", 
     RowBox[{"exported", ".", " ", "Choose"}], " ", "False", " ", 
     RowBox[{"otherwise", ".", " ", "If"}], " ", "you", " ", "want", " ", 
     "to", " ", "export", " ", "the", " ", "results"}], ",", " ", 
    RowBox[{
    "change", " ", "the", " ", "paths", " ", "at", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "file", " ", "to", " ", "the", " ", 
     "appropriate", " ", 
     RowBox[{"destination", "."}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "It", " ", "should", " ", "be", " ", "noted", " ", "that", " ", "a", " ", 
     "total", " ", "number", " ", "of", " ", 
     "\"\<Num*(number of random input variabes + 2)\>\""}], ",", " ", "or", 
    ",", " ", 
    RowBox[{"in", " ", "this", " ", "case"}], ",", " ", 
    RowBox[{
    "Num", "*", "5", " ", "instances", " ", "of", " ", "the", " ", 
     "simulation", " ", "will", " ", "have", " ", "to", " ", "be", " ", 
     RowBox[{"performed", ".", " ", "This"}], " ", "means", " ", "that", " ", 
     "a", " ", "large", " ", "value", " ", "of", " ", "Num", " ", "will", " ",
      "result", " ", "in", " ", "a", " ", "very", " ", "long", " ", 
     "computation", " ", "time"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz00ow3Ecx/Ehxi5DG382GzV5bCKXsYf+tQvWlMRqzFrbIrEZqyHjMMtK
eTg4aIdpajKpYSYcGCe1EmopxdRQ/zZi2El+39/h0+v0ObwrdKYuQyaNRuOj
gX+pZDY/QJHz7jQD3L2ttJcjOz/7naD3xJpVgXQrT7H+++8M0T5FJl3cLLC9
UZ8QH1DkqjL9BW7PHBESpFbyWgJeN2mMciSdzjKDNwZvURtS3v1WDC7LNDVg
ao9TCwbLdwpU8AtfFoHpnTUduPnlw/qJBxvoXAlOgepAnlaN7NWzsXMpTxhU
KuLYeoUuBmrOhrGFHeusPmT1RRor5FiF4FXI3wAePkfMA8g/Zt0YuBlt9muR
uy4Z1rIxO6BD5oyOGMFInckBvkRXsdPx0nNQyhdgnwy/k0NIIt9pBx0Ci9SF
/GkiZODHd3GMEaRIH7sFq4ryAj3IR/UWNjmxoKoKUWSzYRGr4d0w6UeoYzye
Dx7bWDaQEC15QUsixM1FehKtZeDgOyEGuXen2H/7af5i
  "]],

Cell[TextData[StyleBox["Sensitivity Analysis",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.7203670427864056`*^9, 3.7203670501177964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"distrib", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rdist", ",", "sigmadist", ",", "S0dist"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"rm", ",", "rs"}], "]"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"sigmam", ",", "sigmas"}], "]"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"S0m", ",", "S0s"}], "]"}]}], "}"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Vector", " ", "with", " ", "the", " ", "distributions", " ", "of", " ", 
    "each", " ", "input", " ", 
    RowBox[{"variable", "."}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.71664016987416*^9, 3.716640405388695*^9}, 
   3.716640523694661*^9, {3.7166406289788656`*^9, 3.7166407287924023`*^9}, 
   3.7166408736955338`*^9, {3.7166409935201225`*^9, 3.716641003500721*^9}, {
   3.7166591927225947`*^9, 3.716659232971476*^9}, {3.7166594552551517`*^9, 
   3.716659501465242*^9}, {3.716730691247136*^9, 3.7167307156163654`*^9}, {
   3.720363300526164*^9, 3.720363346228857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"matrix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"distrib", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"Table", " ", "with", " ", "distributions"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.71664086355658*^9, 3.7166409087908344`*^9}, {
   3.7166592464108562`*^9, 3.716659339199434*^9}, 3.716659505657576*^9, {
   3.716661260352687*^9, 3.716661261577719*^9}, {3.7167300211708174`*^9, 
   3.716730023969717*^9}, {3.7167302727552567`*^9, 3.7167302743854594`*^9}, {
   3.7167410163575163`*^9, 3.716741053621852*^9}, {3.7167412415747013`*^9, 
   3.7167412445133705`*^9}, {3.7203633566259365`*^9, 3.7203633654979153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatRand1", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"RandomVariate", ",", "matrix", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "Matrix", " ", "with", " ", "the", " ", "randomized", " ", "inputs", " ", 
    "to", " ", "be", " ", "used", " ", "on", " ", "vector", " ", 
    RowBox[{"A", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatRand2", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"RandomVariate", ",", "matrix", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "Matrix", " ", "with", " ", "the", " ", "randomized", " ", "inputs", " ", 
    "to", " ", "be", " ", "used", " ", "on", " ", "vector", " ", "B"}], 
   "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.716640180092534*^9, 3.7166403514131756`*^9}, {
  3.7166405404105844`*^9, 3.716640664550638*^9}, {3.7166409130890646`*^9, 
  3.7166410148649426`*^9}, {3.716659277514274*^9, 3.7166593518896503`*^9}, {
  3.7166612701577716`*^9, 3.71666127407533*^9}, {3.7166614126963935`*^9, 
  3.716661413132805*^9}, {3.716731064433626*^9, 3.716731090923194*^9}, {
  3.7167410109547005`*^9, 3.7167410134035664`*^9}, {3.7203633702599792`*^9, 
  3.720363413083895*^9}, {3.72036392465257*^9, 3.720363946859706*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Param", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", ",", "callput", ",", "n", ",", "T", ",", "k"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Matrix", " ", "with", " ", "non"}], "-", 
    RowBox[{"random", " ", "input", " ", "parameters"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.716741060645384*^9, 3.7167412850203543`*^9}, {
  3.7167420167544985`*^9, 3.716742020330366*^9}, {3.7167422364874673`*^9, 
  3.7167422377810726`*^9}, {3.7177857448548346`*^9, 3.7177857553597436`*^9}, {
  3.720363485032115*^9, 3.7203634933193054`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Param", ",", "MatRand1", ",", "2"}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"Matrix", " ", "with", " ", "input", " ", "parameters", " ", 
    RowBox[{"(", 
     RowBox[{"non", "-", "random", " ", "+", " ", "random"}], ")"}], " ", 
    "to", " ", "be", " ", "used", " ", "on", " ", "vector", " ", 
    RowBox[{"A", ".", " ", "Each"}], " ", "row", " ", "contains", " ", "the", 
    " ", "set", " ", "of", " ", "parameters", " ", "needed", " ", "to", " ", 
    "obtain", " ", "the", " ", "option", " ", 
    RowBox[{"price", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatB", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Param", ",", "MatRand2", ",", "2"}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"Matrix", " ", "with", " ", "input", " ", "parameters", " ", 
    RowBox[{"(", 
     RowBox[{"non", "-", "random", " ", "+", " ", "random"}], ")"}], " ", 
    "to", " ", "be", " ", "used", " ", "on", " ", "vector", " ", "B"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7166614087118945`*^9, 3.716661436600735*^9}, {
  3.716662340124858*^9, 3.716662359458725*^9}, {3.7167280184567986`*^9, 
  3.716728127271947*^9}, {3.716728431285025*^9, 3.7167284384775805`*^9}, {
  3.716730281655876*^9, 3.716730283400236*^9}, {3.716730422933878*^9, 
  3.7167304284495244`*^9}, {3.716731111088111*^9, 3.716731135606498*^9}, {
  3.7167315966789837`*^9, 3.7167316279968586`*^9}, {3.716742004200984*^9, 
  3.7167420081042724`*^9}, {3.716742238947818*^9, 3.7167422403624334`*^9}, {
  3.7203635356202946`*^9, 3.720363582124578*^9}, {3.7203639505370283`*^9, 
  3.720363972508253*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"i", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "Param", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ";", 
     RowBox[{"VMat", "=", 
      RowBox[{"{", "}"}]}]}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{
      RowBox[{"Dimensions", "[", "MatA", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"tmp", "=", "MatB"}], ";", 
     RowBox[{
      RowBox[{"tmp", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}], "=", 
      RowBox[{"MatA", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ";", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"VMat", ",", "tmp"}], "]"}]}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Generation", " ", "of", " ", "input", " ", "parameter", " ", "matrices", 
     " ", 
     RowBox[{
      RowBox[{"VMat", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", " ", "They"}], " ", "are", " ", 
     "similar", " ", "to", " ", "matrix", " ", "MatB"}], ",", " ", 
    RowBox[{"with", " ", "the", " ", 
     RowBox[{"i", "^", "th"}], " ", "column", " ", "replaced", " ", "by", " ",
      "the", " ", 
     RowBox[{"i", "^", "th"}], " ", "column", " ", "of", " ", "matrix", " ", 
     "MatA"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.716741319308914*^9, 3.7167416026411963`*^9}, {
  3.716741744038208*^9, 3.7167417531820345`*^9}, {3.716741984012439*^9, 
  3.716742103629557*^9}, {3.716742247665967*^9, 3.7167423005239224`*^9}, {
  3.718374783239609*^9, 3.7183747969455013`*^9}, {3.7203635884085383`*^9, 
  3.7203637089499874`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fA", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Simul", "@@", 
       RowBox[{"MatA", "[", 
        RowBox[{"[", "it3", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"it3", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming", 
  RowBox[{"(*", 
   RowBox[{"Vector", " ", "A", " ", 
    RowBox[{"generation", ".", " ", "We"}], " ", "use", " ", "the", " ", 
    "input", " ", "matrix", " ", "MatA", " ", "and", " ", "calculate", " ", 
    "the", " ", "option", " ", "price", " ", "using", " ", "all", " ", "the", 
    " ", "input", " ", "parameters", " ", "on", " ", "each", " ", "row"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7184383168247714`*^9, 3.7184383206353483`*^9}, {
  3.7184384376030874`*^9, 3.7184384823417873`*^9}, {3.7184392084423685`*^9, 
  3.7184392676507263`*^9}, {3.7184532316895504`*^9, 3.718453275213601*^9}, {
  3.7203638633764715`*^9, 3.7203639168534527`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8283993018517565`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.718438447889184*^9, 3.718438484999781*^9}, 
   3.718438676112556*^9, 3.7184388065993166`*^9, {3.7184390012328777`*^9, 
   3.7184392747480745`*^9}, 3.718439400679226*^9, 3.7184484690786953`*^9, 
   3.7184501673757935`*^9, {3.718451992784627*^9, 3.718452038275092*^9}, 
   3.718452490576316*^9, 3.7184526160145235`*^9, {3.718452740979125*^9, 
   3.718452832442748*^9}, {3.7184532238901005`*^9, 3.7184532415349474`*^9}, 
   3.7184557149280243`*^9, 3.718466565280772*^9, 3.718479495642575*^9, 
   3.7185316005436926`*^9, 3.7185333142254744`*^9, 3.718533775101752*^9, 
   3.718577996937747*^9, 3.718814825047493*^9, 3.718929242332383*^9, 
   3.719910087602061*^9, 3.720086079214893*^9, 3.7200920348148212`*^9, {
   3.720364274091738*^9, 3.720364302051809*^9}, 3.7203644496117096`*^9, 
   3.720364499556562*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fB", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Simul", "@@", 
      RowBox[{"MatB", "[", 
       RowBox[{"[", "it4", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"it4", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"Vector", " ", "B", " ", 
    RowBox[{"generation", "."}]}], "*)"}]}]], "Input",
 CellChangeTimes->{
  3.718438495353545*^9, {3.718439236398389*^9, 3.7184392700787406`*^9}, {
   3.718453278140724*^9, 3.718453287466115*^9}, 3.7203638444683547`*^9, {
   3.720363982113291*^9, 3.72036399257937*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"it2", "=", "1"}], ";", 
       RowBox[{"fVA", "=", 
        RowBox[{"{", "}"}]}]}], ",", 
      RowBox[{"it2", "<=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "VMat", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"it2", "++"}], ",", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Simul", "@@", 
           RowBox[{"VMat", "[", 
            RowBox[{"[", 
             RowBox[{"it2", ",", "it1"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"it1", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"fVA", ",", "tmp"}], "]"}]}]}], "]"}], ",", 
    RowBox[{"ProgressIndicator", "[", 
     RowBox[{"it2", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", "VMat", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ";", 
  RowBox[{"(*", 
   RowBox[{"Vectors", " ", 
    RowBox[{"fVA", "[", 
     RowBox[{"[", "i", "]"}], "]"}], " ", 
    RowBox[{"generation", ".", " ", "The"}], " ", "inputs", " ", "used", " ", 
    "were", " ", "the", " ", "matrices", " ", 
    RowBox[{
     RowBox[{"VMat", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "."}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7167304071822057`*^9, 3.716730535381955*^9}, 
   3.716730937149556*^9, {3.7167315751778173`*^9, 3.7167315926262946`*^9}, {
   3.7167412907761626`*^9, 3.7167412977677903`*^9}, {3.716742010550888*^9, 
   3.7167420136977572`*^9}, {3.7167422412984343`*^9, 
   3.7167422433542843`*^9}, {3.7167424173192153`*^9, 
   3.7167426115563025`*^9}, {3.7167427217742634`*^9, 3.716743027339649*^9}, {
   3.7167431354463835`*^9, 3.716743294240864*^9}, {3.7167434634573946`*^9, 
   3.7167436093492393`*^9}, {3.7177859748494864`*^9, 
   3.7177859753398066`*^9}, {3.7183748108448615`*^9, 3.718374813031918*^9}, {
   3.718375186364918*^9, 3.718375200945133*^9}, {3.7184002448723907`*^9, 
   3.7184002642257843`*^9}, {3.7184382602745557`*^9, 3.718438312472669*^9}, {
   3.718438498175537*^9, 3.71843865063345*^9}, {3.7184387575291805`*^9, 
   3.7184391962354975`*^9}, {3.718453293234694*^9, 3.7184533110945306`*^9}, 
   3.7203638391711454`*^9, {3.7203640012330656`*^9, 3.7203640429272337`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "=", "1"}], ";", 
     RowBox[{"Vi", "=", 
      RowBox[{"{", "}"}]}]}], ",", 
    RowBox[{"x", "\[LessEqual]", 
     RowBox[{
      RowBox[{"Dimensions", "[", "fVA", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"x", "++"}], ",", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"1", "/", "Num"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"fA", "[", 
           RowBox[{"[", "w", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fVA", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", "w"}], "]"}], "]"}], "-", 
            RowBox[{"fB", "[", 
             RowBox[{"[", "w", "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"w", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"Vi", ",", "tmp"}], "]"}]}]}], "]"}], " ", ";", "Vi", 
  RowBox[{"(*", 
   RowBox[{
   "Contribution", " ", "of", " ", "each", " ", "variable", " ", "to", " ", 
    "the", " ", "final", " ", 
    RowBox[{"variance", ".", " ", "The"}], " ", "output", " ", "is", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", ",", "sigma", ",", "S0"}], ")"}], "."}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7183903580934005`*^9, 3.718390535041298*^9}, {
  3.7184314637806377`*^9, 3.7184314673666716`*^9}, {3.720364048981085*^9, 
  3.7203642004096084`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.007826192935466865`"}], ",", 
   RowBox[{"-", "0.003967118872981445`"}], ",", "0.0010117412612052734`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7203642881640224`*^9, 3.7203643023526382`*^9}, 
   3.720364452931049*^9, 3.720364502419321*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BarChart", "[", 
  RowBox[{
   RowBox[{"Vi", "/", 
    RowBox[{"Total", "[", 
     RowBox[{"Vi", ",", "2"}], "]"}]}], ",", 
   RowBox[{"ChartLabels", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<\[Sigma]\>\"", ",", "\"\<S0\>\""}], 
     "}"}]}], ",", 
   RowBox[{"LabelingFunction", "\[Rule]", "Above"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.719074131620195*^9, 3.71907414940376*^9}, {
  3.719074325102871*^9, 3.719074360430854*^9}, {3.7190744780830536`*^9, 
  3.7190745796184444`*^9}, {3.7203640875551305`*^9, 3.72036409070266*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {Opacity[0], PointBox[{0.48597994530537825`, 0}]}, {{}, 
    {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
     0.6789999999999999], Thickness[Small]}], 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6789999999999999], Thickness[Small]}], 
      DynamicBox[{
        FEPrivate`If[
         CurrentValue["MouseOver"], 
         EdgeForm[{
           GrayLevel[0.5], 
           AbsoluteThickness[1.5], 
           Opacity[0.66]}], {}, {}], 
        RectangleBox[{0.544211485870556, 0.}, {1.455788514129444, 
         0.725886168547875}, "RoundingRadius" -> 0]},
       ImageSizeCache->{{24.17139208624627, 
        125.19412355534874`}, {-97.24999999999999, 74.63900558467434}}]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6789999999999999], Thickness[Small]}], 
      DynamicBox[{
        FEPrivate`If[
         CurrentValue["MouseOver"], 
         EdgeForm[{
           GrayLevel[0.5], 
           AbsoluteThickness[1.5], 
           Opacity[0.66]}], {}, {}], 
        RectangleBox[{1.544211485870556, 0.}, {2.455788514129444, 
         0.3679537091185551}, "RoundingRadius" -> 0]},
       ImageSizeCache->{{134.44482850785167`, 
        235.4675599769541}, {-12.73855599385628, 74.63900558467434}}]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6789999999999999], Thickness[Small]}], 
      DynamicBox[{
        FEPrivate`If[
         CurrentValue["MouseOver"], 
         EdgeForm[{
           GrayLevel[0.5], 
           AbsoluteThickness[1.5], 
           Opacity[0.66]}], {}, {}], 
        RectangleBox[{2.544211485870556, 0.}, {
         3.455788514129444, -0.09383987766643019}, "RoundingRadius" -> 0]},
       ImageSizeCache->{{244.71826492945704`, 345.74099639855945`}, {
        74.13900558467434, 96.79554198708439}}]}}, {}, {}}, {}, {
    InsetBox["0.725886168547875`", Offset[{0, 4}, {1., 0.725886168547875}], 
     ImageScaled[{0.5, 0}]], 
    InsetBox["0.3679537091185551`", Offset[{0, 4}, {2., 0.3679537091185551}], 
     ImageScaled[{0.5, 0}]], InsetBox[
     RowBox[{"-", "0.09383987766643019`"}], Offset[{0, 4}, {3., 0.}], 
     ImageScaled[{0.5, 0}]]}, 
   StyleBox[{
     {Thickness[Tiny], 
      LineBox[{{0.48597994530537825`, 0.}, {3.5151846855059254`, 0.}}], 
      StyleBox[{}, "GraphicsLabel",
       StripOnInput->False]}, 
     StyleBox[{
       {Thickness[Tiny], 
        LineBox[{{0.544211485870556, 0.}, 
          Offset[{-1.102182119232618*^-15, -6.}, {0.544211485870556, 0.}]}], 
        LineBox[{{3.455788514129444, 0.}, 
          Offset[{-1.102182119232618*^-15, -6.}, {3.455788514129444, 
           0.}]}], {{}, {}, {}, {
          LineBox[{{1.455788514129444, 0.}, 
            Offset[{-7.347880794884119*^-16, -4.}, {1.455788514129444, 0.}]}],
           LineBox[{{1.544211485870556, 0.}, 
            Offset[{-7.347880794884119*^-16, -4.}, {1.544211485870556, 0.}]}],
           LineBox[{{2.455788514129444, 0.}, 
            Offset[{-7.347880794884119*^-16, -4.}, {2.455788514129444, 0.}]}],
           LineBox[{{2.544211485870556, 0.}, 
            Offset[{-7.347880794884119*^-16, -4.}, {2.544211485870556, 
             0.}]}]}, {}}}, 
       StyleBox[
        {Thickness[Tiny], 
         InsetBox["\<\"r\"\>", Offset[{0., -2.}, {1., 0.}], {0, 1}, 
          Automatic, {1, 0}], 
         InsetBox["\<\"\[Sigma]\"\>", Offset[{0., -2.}, {2., 0.}], {0, 1}, 
          Automatic, {1, 0}], 
         InsetBox["\<\"S0\"\>", Offset[{0., -2.}, {3., 0.}], {0, 1}, 
          Automatic, {1, 0}]}, "GraphicsLabel",
        StripOnInput->False]}, "GraphicsTicks",
      StripOnInput->False]}, "GraphicsAxes",
    StripOnInput->False,
    Antialiasing->False]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.48597994530537825`, 0},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& )},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {{{1., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {1., 
       FormBox["\"r\"", TraditionalForm], 0}, {2., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {2., 
       FormBox["\"\[Sigma]\"", TraditionalForm], 0}, {3., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {3., 
       FormBox["\"S0\"", TraditionalForm], 0}}, {{1., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {2., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {3., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotRange->{{All, All}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{None, Automatic}]], "Output",
 CellChangeTimes->{
  3.719074151016547*^9, {3.7190743417051697`*^9, 3.7190743611227007`*^9}, {
   3.719074485809703*^9, 3.719074579962562*^9}, 3.7201160277550335`*^9, {
   3.720364292167577*^9, 3.7203643025063257`*^9}, 3.7203644531313553`*^9, 
   3.7203645025573044`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"MatRand1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"MatRand2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], "]"}], 
   ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Sigma]\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7188852534919825`*^9, 3.718885758674271*^9}, {
  3.7188858912494326`*^9, 3.718885901327745*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAsrD3cuFPyT+pMlQ+2j34PyignZOh
3Mk/k2y8Yh0sAECqoDaA9RnKP2lNjokPMfo/9mfarZjgyD8mlMKTYr8AQMps
M/eSUco/5CVdCx1I+j8bsiVuUDbJP24jWQYzgPc/ch/RyEA0yj8qkTZedST2
P5y7pthWG8o/RSfR5NmSAUAxc8hNfVLHPzN3Wm288Os/6auPql1FyD9mZiPX
ehfzP8cHqA6bU8o/u2quT7um9D+zVVEOhsjGP07GS40aw+c/OujDSXmzyD8B
1AYChpr3P8f6R99IsMk/p+o2f0dm9D9dMVVe2NrKP6cwHvMNKvY/PUTralN+
yT9f/k+EXdb3PyIXv/duOsg/yV8u0jy/9z/7h+dxpCjKP1hf9tg+bvk/g/ys
BDWpyD/G8e7xFq7yP9uum5Z5T8o/hThEHWR3+D9zlKAl
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"\[Sigma]\"", TraditionalForm], 
    FormBox["\"option price\"", TraditionalForm]},
  AxesOrigin->{0.17749747869906873`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0.1779944963370049, 0.20980362516491882`}, {
    0, 2.1967046619728614`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7188853607617073`*^9, 3.7188857590972066`*^9}, {
   3.7188859019403324`*^9, 3.7188859555880527`*^9}, 3.719058893937584*^9, 
   3.720097992778202*^9, {3.720364293687042*^9, 3.7203643026534805`*^9}, 
   3.720364453247262*^9, 3.7203645026575804`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"MatRand1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"MatRand2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], "]"}], 
   ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.718885657814292*^9, 3.718885657970828*^9}, {
  3.7188857741501493`*^9, 3.71888578029749*^9}, {3.7188859283059716`*^9, 
  3.7188859470862336`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAdA+qCQ7crj+pMlQ+2j34P67YHTnj
3q0/k2y8Yh0sAEBvabRxRtOuP2lNjokPMfo/1MxQHWOirT8mlMKTYr8AQLf3
6BeToq0/5CVdCx1I+j+x8sOnkuSuP24jWQYzgPc/k5DeUfxerj8qkTZedST2
P4hP7sJKs64/RSfR5NmSAUCvo07tnnGvPzN3Wm288Os/+VYOmoMCrj9mZiPX
ehfzP4+9++caRK8/u2quT7um9D8nYNjlInCvP07GS40aw+c/1qgzMrS+rz8B
1AYChpr3P0yhKdL5l64/p+o2f0dm9D9cJ86bBCuuP6cwHvMNKvY/pglEwizA
rj9f/k+EXdb3P7xJcLSxRK4/yV8u0jy/9z8ERfho0ZGuP1hf9tg+bvk/yYJr
k09krz/G8e7xFq7yPyggL+fpdK4/hThEHWR3+D8sdZ7G
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"r\"", TraditionalForm], 
    FormBox["\"option price\"", TraditionalForm]},
  AxesOrigin->{0.05781512998385344, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0.05787954075676685, 0.062001830223225404`}, {
    0, 2.1967046619728614`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.7188856590994215`*^9, {3.718885782096718*^9, 3.7188858194508357`*^9}, 
   3.718885957470745*^9, 3.719058893990512*^9, 3.720097992831637*^9, {
   3.7203642943260856`*^9, 3.7203643028918114`*^9}, 3.720364453327902*^9, 
   3.720364502757861*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"MatRand1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"MatRand2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], "]"}], 
   ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<S0\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7188858119976788`*^9, 3.71888581667787*^9}, {
  3.718885934283245*^9, 3.7188859419037714`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAQbJB6y30RUCpMlQ+2j34P3/HgT+U
DkZAk2y8Yh0sAEAYevzkk/VFQGlNjokPMfo/BSZLeN32RUAmlMKTYr8AQJUB
X0VN/kVA5CVdCx1I+j9NsRWerQFGQG4jWQYzgPc/ZFKyfqvqRUAqkTZedST2
PwzesCTp8EVARSfR5NmSAUCINYv6CxdGQDN3Wm288Os/zvPCksQbRkBmZiPX
ehfzP3zGQtk5AUZAu2quT7um9D8NATzuOv1FQE7GS40aw+c/yWj9mh73RUAB
1AYChpr3P0mzGHvo/EVAp+o2f0dm9D/P0yLbrfdFQKcwHvMNKvY/KTRsldwI
RkBf/k+EXdb3P2rh9Wn75UVAyV8u0jy/9z9F57tshwlGQFhf9tg+bvk/W6/p
YyvnRUDG8e7xFq7yP74RKqpt/0VAhThEHWR3+D8Sz5b9
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"S0\"", TraditionalForm], 
    FormBox["\"option price\"", TraditionalForm]},
  AxesOrigin->{43.79016939675262, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{43.79673504358182, 44.21693644065054}, {
    0, 2.1967046619728614`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.718885817166256*^9, 3.7188859607075624`*^9, 3.7190588940219717`*^9, 
   3.720097992878544*^9, {3.7203642943885927`*^9, 3.720364302969948*^9}, 
   3.7203644533944163`*^9, 3.7203645028581333`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "If", " ", "the", " ", "variable", " ", "Exporting", " ", "was", " ", 
     "set", " ", "to", " ", "True"}], ",", " ", 
    RowBox[{"export", " ", "the", " ", 
     RowBox[{"results", ".", " ", "This"}], " ", "might", " ", "be", " ", 
     "useful", " ", "to", " ", "avoid", " ", "repeating", " ", "lengthy", " ", 
     RowBox[{"computations", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"Exporting", ",", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\MatA6.m\>\"", ",", "MatA"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\MatB6.m\>\"", ",", "MatB"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\fA6.m\>\"", ",", "fA"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\fB6.m\>\"", ",", "fB"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\fVA6.m\>\"", ",", "fVA"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\Param6.m\>\"", ",", 
         RowBox[{"Param", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ","}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"Exporting", ",", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Images\\\\sigma6.eps\>\"", ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"MatRand1", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"MatRand2", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Sigma]\>\"", ",", "\"\<option price\>\""}], 
             "}"}]}]}], "]"}], ",", "\"\<eps\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Images\\\\r6.eps\>\"", ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"MatRand1", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"MatRand2", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<r\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Images\\\\S06.eps\>\"", ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"MatRand1", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
                 RowBox[{"MatRand2", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<S0\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
          "]"}], ",", "\"\<eps\>\""}], "]"}]}], ","}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7190746265386105`*^9, 3.719074835142562*^9}, {
  3.719075729672616*^9, 3.7190758646329126`*^9}, {3.719771981300747*^9, 
  3.719771993302252*^9}, {3.720362066662814*^9, 3.7203620736341534`*^9}, {
  3.720362123997972*^9, 3.7203621569983487`*^9}, {3.720364210137968*^9, 
  3.7203642531552467`*^9}}],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7201582615698204`*^9, 3.720158262348882*^9}}]
},
WindowSize->{681, 676},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2512, 61, 252, "Input"],
Cell[3095, 85, 256, 5, 31, "Output"]
}, Open  ]],
Cell[3366, 93, 256, 6, 43, "Text"],
Cell[3625, 101, 2891, 68, 312, "Input"],
Cell[6519, 171, 245, 6, 43, "Text"],
Cell[6767, 179, 3604, 90, 372, "Input"],
Cell[10374, 271, 255, 6, 43, "Text"],
Cell[10632, 279, 1107, 25, 92, "Input"],
Cell[11742, 306, 733, 14, 52, "Input"],
Cell[12478, 322, 1294, 26, 112, "Input"],
Cell[13775, 350, 708, 16, 52, "Input"],
Cell[14486, 368, 1661, 31, 152, "Input"],
Cell[16150, 401, 1743, 46, 172, "Input"],
Cell[CellGroupData[{
Cell[17918, 451, 994, 22, 92, "Input"],
Cell[18915, 475, 922, 14, 31, "Output"]
}, Open  ]],
Cell[19852, 492, 611, 16, 52, "Input"],
Cell[20466, 510, 2454, 56, 152, "Input"],
Cell[CellGroupData[{
Cell[22945, 570, 1537, 44, 132, "Input"],
Cell[24485, 616, 303, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24825, 628, 582, 13, 52, "Input"],
Cell[25410, 643, 6341, 151, 238, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31788, 799, 839, 24, 72, "Input"],
Cell[32630, 825, 1719, 39, 243, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34386, 869, 882, 25, 72, "Input"],
Cell[35271, 896, 1710, 40, 245, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37018, 941, 832, 24, 72, "Input"],
Cell[37853, 967, 1655, 39, 240, "Output"]
}, Open  ]],
Cell[39523, 1009, 5578, 134, 912, "Input"],
Cell[45104, 1145, 128, 2, 31, "Input"]
}
]
*)

