(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50896,       1270]
NotebookOptionsPosition[     49283,       1215]
NotebookOutlinePosition[     49624,       1230]
CellTagsIndexPosition[     49581,       1227]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "clear", " ", "all", " ", "variables", " ", "to", " ", "avoid", " ", 
    "errors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NotebookSave", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"DateList", "[", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "Hour", " ", "when", " ", "the", " ", "computation", " ", "started"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Get", "[", 
    "\"\<C:\\\\Users\\\\Miguel \
Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\\Functions\\\\Function_Garch.m\>\"\
", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "get", " ", "function", " ", "\"\<Simul\>\"", " ", "written", " ", "on", 
     " ", "file", " ", 
     RowBox[{"Function_Garch", ".", "nb", ".", " ", "This"}], " ", "function",
      " ", "does", " ", "exactly", " ", "the", " ", "same", " ", "as", " ", 
     "the", " ", "whole", " ", "file", " ", 
     RowBox[{"Simulation_Garch", ".", "nb"}]}], ",", " ", 
    RowBox[{
    "only", " ", "it", " ", "does", " ", "it", " ", "as", " ", "a", " ", 
     "single", " ", "function", " ", "with", " ", "a", " ", "single", " ", 
     "return", " ", "that", " ", "corresponds", " ", "to", " ", "the", " ", 
     "option", " ", 
     RowBox[{"price", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "expects", " ", "the", " ", "inputs"}], " ",
     "-", " ", 
    RowBox[{
     RowBox[{"Simul", "[", 
      RowBox[{
      "M", ",", "callput", ",", "n", ",", "T", ",", "K", ",", "r", ",", 
       "sigma", ",", "S0", ",", "a", ",", "b", ",", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"see", " ", "below"}], ")"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7142450096927867`*^9, 3.7142450096927867`*^9}, {
   3.714248961487697*^9, 3.7142489620035844`*^9}, {3.7167307321716595`*^9, 
   3.7167307326058245`*^9}, 3.716730889167138*^9, {3.7185324613959336`*^9, 
   3.7185324685044785`*^9}, 3.718797026817216*^9, {3.7197686534557323`*^9, 
   3.719768654587603*^9}, {3.7203616593756423`*^9, 3.7203616616685314`*^9}, {
   3.7203645975062046`*^9, 3.7203646097046947`*^9}, {3.7203646592104797`*^9, 
   3.720364764283146*^9}, {3.7203653217057123`*^9, 3.7203653354680824`*^9}, {
   3.7203654666105766`*^9, 3.720365469448925*^9}, 3.720366884033018*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"19", ",", "49", ",", "45.9053044`9.414437737983416"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.720365316839028*^9, 3.7203653859053044`*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["Set Parameters",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.716731237908811*^9, 3.716731259015463*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Num", "=", "500"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Number", " ", "of", " ", "simulations", " ", "per", " ", "vector"}], 
     " ", "-", " ", 
     RowBox[{
     "See", " ", "the", " ", "article", " ", "by", " ", "Sobol", " ", "for", 
      " ", "more", " ", "information"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"M", "=", "50000"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "paths", " ", "to", " ", "be", " ", "generated",
      " ", "on", " ", "each", " ", "simulation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"callput", "=", "\"\<Put\>\""}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Type", " ", "of", " ", "option"}], " ", "-", " ", 
     RowBox[{"\"\<Call\>\"", " ", "or", " ", "\"\<Put\>\""}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"n", "=", "12."}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "exercise", " ", "chances", " ", "per", " ", 
     "year"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"T", "=", "1."}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "years", " ", "until", " ", "exercise"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"k", "=", "40."}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"Strike", " ", "price"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Exporting", "=", "False"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Choose", " ", "True", " ", "if", " ", "you", " ", "want", " ", "the", 
     " ", "final", " ", "matrices", " ", "and", " ", "images", " ", "to", " ",
      "be", " ", 
     RowBox[{"exported", ".", " ", "Choose"}], " ", "False", " ", 
     RowBox[{"otherwise", ".", " ", "If"}], " ", "you", " ", "want", " ", 
     "to", " ", "export", " ", "the", " ", "results"}], ",", " ", 
    RowBox[{
    "change", " ", "the", " ", "paths", " ", "at", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "file", " ", "to", " ", "the", " ", 
     "appropriate", " ", 
     RowBox[{"destination", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "It", " ", "should", " ", "be", " ", "noted", " ", "that", " ", "a", " ", 
     "total", " ", "number", " ", "of", " ", 
     "\"\<Num*(number of random input variabes + 2)\>\""}], ",", " ", "or", 
    ",", " ", 
    RowBox[{"in", " ", "this", " ", "case"}], ",", " ", 
    RowBox[{
    "Num", "*", "5", " ", "instances", " ", "of", " ", "the", " ", 
     "simulation", " ", "will", " ", "have", " ", "to", " ", "be", " ", 
     RowBox[{"performed", ".", " ", "This"}], " ", "means", " ", "that", " ", 
     "a", " ", "large", " ", "value", " ", "of", " ", "Num", " ", "will", " ",
      "result", " ", "in", " ", "a", " ", "very", " ", "long", " ", 
     "computation", " ", "time"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "volatility", " ", "is", " ", "updated", " ", "using", " ", 
    "the", " ", "GARCH", 
    RowBox[{"(", 
     RowBox[{"1", ",", "1"}], ")"}], " ", 
    RowBox[{"model", ".", " ", "The"}], " ", "following", " ", "equation", 
    " ", "is", " ", 
    RowBox[{"used", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sigma_", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", "+", "1"}], ")"}], "^", "2"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"a", " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"S_", 
           RowBox[{"(", 
            RowBox[{"i", "+", "1"}], ")"}]}], "-", "S_i"}], ")"}], "/", 
        RowBox[{"(", "S_i", ")"}]}], ")"}]}], " ", "+", " ", 
     RowBox[{"b", " ", "*", " ", 
      RowBox[{"sigma_i", "^", "2"}]}], " ", "+", " ", "w"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\"\<a\>\"", " ", "indicates", " ", "the", " ", "influence", " ", "of", 
     " ", "the", " ", "price", " ", "change", " ", "in", " ", "the", " ", 
     RowBox[{"volatility", ".", " ", "\"\<b\>\""}], " ", "indicates", " ", 
     "the", " ", "influence", " ", "of", " ", "the", " ", "previous", " ", 
     "volatility", " ", "on", " ", "the", " ", "future", " ", 
     RowBox[{"volatility", ".", " ", "\"\<w\>\""}], " ", "is", " ", "related",
      " ", "to", " ", "the", " ", "influence", " ", "of", " ", "the", " ", 
     "long"}], "-", 
    RowBox[{"term", " ", "volatility"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", "0.3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7167411674674063`*^9, 3.7167412077691064`*^9}, {
   3.71674417718209*^9, 3.7167442429358287`*^9}, {3.716745243679155*^9, 
   3.716745245884596*^9}, {3.717842959682821*^9, 3.717842968891837*^9}, {
   3.7183752751310167`*^9, 3.718375327759591*^9}, {3.71837562176534*^9, 
   3.718375631226242*^9}, {3.7183905789437027`*^9, 3.718390656625858*^9}, {
   3.718400181106179*^9, 3.7184001912602863`*^9}, {3.718400330945259*^9, 
   3.718400336865595*^9}, {3.7184308613789926`*^9, 3.718430902148781*^9}, {
   3.7184315087086143`*^9, 3.7184315092484913`*^9}, {3.718431686878011*^9, 
   3.718431701674014*^9}, {3.7184376323029*^9, 3.7184376326684985`*^9}, {
   3.718438421029846*^9, 3.7184384231655645`*^9}, {3.7184386670717983`*^9, 
   3.7184386673672323`*^9}, {3.718439076821664*^9, 3.718439079773823*^9}, {
   3.718439283659568*^9, 3.718439293366185*^9}, {3.7184459584339247`*^9, 
   3.718445961345702*^9}, {3.7184484736513233`*^9, 3.7184484739855566`*^9}, {
   3.7184519639884577`*^9, 3.7184520194196806`*^9}, {3.718452259474097*^9, 
   3.718452260588855*^9}, {3.7184527448405128`*^9, 3.7184527451288137`*^9}, {
   3.718466511731186*^9, 3.7184665481894646`*^9}, {3.7185315715669575`*^9, 
   3.718531576756221*^9}, {3.7187970647487717`*^9, 3.718797065815143*^9}, {
   3.718952328963787*^9, 3.7189523332612147`*^9}, {3.719769026457144*^9, 
   3.7197690287386465`*^9}, {3.719770649528075*^9, 3.719770656234958*^9}, {
   3.719810588081684*^9, 3.7198105888348446`*^9}, {3.7198382521301603`*^9, 
   3.719838273426216*^9}, {3.7198615980473804`*^9, 3.71986159819661*^9}, {
   3.7198617628940425`*^9, 3.719861781555421*^9}, {3.719903591128069*^9, 
   3.719903617304366*^9}, {3.719924497120329*^9, 3.719924511454214*^9}, {
   3.7199248512681293`*^9, 3.7199248552571764`*^9}, {3.719925026872861*^9, 
   3.7199250757025747`*^9}, {3.7199255897747507`*^9, 
   3.7199257197484226`*^9}, {3.7200067920152235`*^9, 
   3.7200068217148576`*^9}, {3.7200070204494734`*^9, 
   3.7200070381557074`*^9}, {3.720007938171586*^9, 3.720007987117124*^9}, {
   3.720158621188985*^9, 3.7201587455803394`*^9}, {3.7202127470059433`*^9, 
   3.720212764705535*^9}, 3.7202584361669083`*^9, 3.720364574116463*^9, {
   3.7203648504608436`*^9, 3.720364850677559*^9}, {3.7203648830671406`*^9, 
   3.7203650281850324`*^9}, {3.7203650803164673`*^9, 
   3.7203652035542593`*^9}, {3.7203653096043425`*^9, 3.720365313930686*^9}, {
   3.7203654074847946`*^9, 3.720365413734972*^9}, {3.720366957174314*^9, 
   3.7203669801600456`*^9}}],

Cell[TextData[StyleBox["Distribution Parameters",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.7167305839751053`*^9, 3.716730589395534*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "we", " ", "assume", " ", "the", " ", "variables", " ", "for", " ", "the",
      " ", "interest", " ", "rate", " ", 
     RowBox[{"(", "r", ")"}]}], ",", " ", 
    RowBox[{"stock", " ", "price", " ", "volatility", " ", 
     RowBox[{"(", "\[Sigma]", ")"}], " ", "and", " ", "initial", " ", "stock",
      " ", "price", " ", 
     RowBox[{"(", "S0", ")"}], " ", "follow", " ", "a", " ", "normal", " ", 
     RowBox[{"distribution", ".", " ", "This"}], " ", "particular", " ", 
     "choice", " ", "of", " ", "variables", " ", "was", " ", 
     RowBox[{"arbitrary", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "output", " ", "of", " ", "the", " ", 
     "sensitivity", " ", "analysis"}], ",", " ", "Vi", ",", " ", 
    RowBox[{"for", " ", "each", " ", "of", " ", "these", " ", "variables"}], 
    ",", " ", 
    RowBox[{
    "will", " ", "indicate", " ", "what", " ", "fraction", " ", "of", " ", 
     "price", " ", "variance", " ", "is", " ", "generated", " ", "by", " ", 
     "the", " ", "individual", " ", "variance", " ", "of", " ", "the", " ", 
     "respective", " ", 
     RowBox[{"input", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rm", "=", "0.06"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"interest", " ", "rate", " ", "expected", " ", "value"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rs", "=", "0.001"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"interest", " ", "rate", " ", "standard", " ", "deviation"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"sigmam", "=", "0.2"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "stock", " ", "price", " ", "volatility", " ", "expected", " ", "value"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"sigmas", "=", "0.01"}], ";", 
   RowBox[{"(*", 
    RowBox[{
    "stock", " ", "price", " ", "volatility", " ", "standard", " ", 
     "deviation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"S0m", "=", "44."}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "initial", " ", "stock", " ", "price", " ", "expected", " ", "value"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"S0s", "=", ".1"}], ";", 
   RowBox[{"(*", 
    RowBox[{
    "initial", " ", "stock", " ", "price", " ", "standard", " ", 
     "deviation"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.716730613077941*^9, 3.7167307190395746`*^9}, {
   3.7167313734510574`*^9, 3.716731373575374*^9}, {3.7185316704376893`*^9, 
   3.7185317221496215`*^9}, {3.7188962818556414`*^9, 3.718896325890917*^9}, 
   3.718896470126851*^9, {3.719768713285705*^9, 3.7197688122887745`*^9}, {
   3.719769082130274*^9, 3.719769084537986*^9}, {3.7198104790187354`*^9, 
   3.7198105011764154`*^9}, {3.719861554983511*^9, 3.7198615877721834`*^9}, {
   3.719861901048112*^9, 3.719861957976866*^9}, {3.71992451491749*^9, 
   3.719924596744568*^9}, {3.720158476374652*^9, 3.7201585585875072`*^9}, {
   3.7203647824150066`*^9, 3.720364854972374*^9}, {3.7203669018642807`*^9, 
   3.7203669257970977`*^9}}],

Cell[TextData[StyleBox["Sensitivity Analysis",
 FontFamily->"Calibri",
 FontSize->24,
 FontWeight->"Bold",
 FontVariations->{"Underline"->True},
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.720366992466827*^9, 3.720367038392494*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"distrib", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rdist", ",", "sigmadist", ",", "S0dist"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"rm", ",", "rs"}], "]"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"sigmam", ",", "sigmas"}], "]"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"S0m", ",", "S0s"}], "]"}]}], "}"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Vector", " ", "with", " ", "the", " ", "distributions", " ", "of", " ", 
    "each", " ", "input", " ", 
    RowBox[{"variable", "."}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.71664016987416*^9, 3.716640405388695*^9}, 
   3.716640523694661*^9, {3.7166406289788656`*^9, 3.7166407287924023`*^9}, 
   3.7166408736955338`*^9, {3.7166409935201225`*^9, 3.716641003500721*^9}, {
   3.7166591927225947`*^9, 3.716659232971476*^9}, {3.7166594552551517`*^9, 
   3.716659501465242*^9}, {3.716730691247136*^9, 3.7167307156163654`*^9}, {
   3.720363300526164*^9, 3.720363346228857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"matrix", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"distrib", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Table", " ", "with", " ", "distributions"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.71664086355658*^9, 3.7166409087908344`*^9}, {
   3.7166592464108562`*^9, 3.716659339199434*^9}, 3.716659505657576*^9, {
   3.716661260352687*^9, 3.716661261577719*^9}, {3.7167300211708174`*^9, 
   3.716730023969717*^9}, {3.7167302727552567`*^9, 3.7167302743854594`*^9}, {
   3.7167410163575163`*^9, 3.716741053621852*^9}, {3.7167412415747013`*^9, 
   3.7167412445133705`*^9}, {3.7203633566259365`*^9, 3.7203633654979153`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatRand1", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"RandomVariate", ",", "matrix", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Matrix", " ", "with", " ", "the", " ", "randomized", " ", "inputs", " ", 
    "to", " ", "be", " ", "used", " ", "on", " ", "vector", " ", 
    RowBox[{"A", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatRand2", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"RandomVariate", ",", "matrix", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Matrix", " ", "with", " ", "the", " ", "randomized", " ", "inputs", " ", 
    "to", " ", "be", " ", "used", " ", "on", " ", "vector", " ", "B"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.716640180092534*^9, 3.7166403514131756`*^9}, {
  3.7166405404105844`*^9, 3.716640664550638*^9}, {3.7166409130890646`*^9, 
  3.7166410148649426`*^9}, {3.716659277514274*^9, 3.7166593518896503`*^9}, {
  3.7166612701577716`*^9, 3.71666127407533*^9}, {3.7166614126963935`*^9, 
  3.716661413132805*^9}, {3.716731064433626*^9, 3.716731090923194*^9}, {
  3.7167410109547005`*^9, 3.7167410134035664`*^9}, {3.7203633702599792`*^9, 
  3.720363413083895*^9}, {3.72036392465257*^9, 3.720363946859706*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Param", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", "callput", ",", "n", ",", "T", ",", "k"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Matrix", " ", "with", " ", "non"}], "-", 
    RowBox[{"random", " ", "input", " ", "parameters"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.716741060645384*^9, 3.7167412850203543`*^9}, {
  3.7167420167544985`*^9, 3.716742020330366*^9}, {3.7167422364874673`*^9, 
  3.7167422377810726`*^9}, {3.7177857448548346`*^9, 3.7177857553597436`*^9}, {
  3.720363485032115*^9, 3.7203634933193054`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatA", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"Param", ",", "MatRand1", ",", "2"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Matrix", " ", "with", " ", "input", " ", "parameters", " ", 
    RowBox[{"(", 
     RowBox[{"non", "-", "random", " ", "+", " ", "random"}], ")"}], " ", 
    "to", " ", "be", " ", "used", " ", "on", " ", "vector", " ", 
    RowBox[{"A", ".", " ", "Each"}], " ", "row", " ", "contains", " ", "the", 
    " ", "set", " ", "of", " ", "parameters", " ", "needed", " ", "to", " ", 
    "obtain", " ", "the", " ", "option", " ", 
    RowBox[{"price", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatB", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"Param", ",", "MatRand2", ",", "2"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Matrix", " ", "with", " ", "input", " ", "parameters", " ", 
    RowBox[{"(", 
     RowBox[{"non", "-", "random", " ", "+", " ", "random"}], ")"}], " ", 
    "to", " ", "be", " ", "used", " ", "on", " ", "vector", " ", "B"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7166614087118945`*^9, 3.716661436600735*^9}, {
  3.716662340124858*^9, 3.716662359458725*^9}, {3.7167280184567986`*^9, 
  3.716728127271947*^9}, {3.716728431285025*^9, 3.7167284384775805`*^9}, {
  3.716730281655876*^9, 3.716730283400236*^9}, {3.716730422933878*^9, 
  3.7167304284495244`*^9}, {3.716731111088111*^9, 3.716731135606498*^9}, {
  3.7167315966789837`*^9, 3.7167316279968586`*^9}, {3.716742004200984*^9, 
  3.7167420081042724`*^9}, {3.716742238947818*^9, 3.7167422403624334`*^9}, {
  3.7203635356202946`*^9, 3.720363582124578*^9}, {3.7203639505370283`*^9, 
  3.720363972508253*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"i", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "Param", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ";", 
     RowBox[{"VMat", "=", 
      RowBox[{"{", "}"}]}]}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{
      RowBox[{"Dimensions", "[", "MatA", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"tmp", "=", "MatB"}], ";", 
     RowBox[{
      RowBox[{"tmp", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}], "=", 
      RowBox[{"MatA", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ";", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"VMat", ",", "tmp"}], "]"}]}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Generation", " ", "of", " ", "input", " ", "parameter", " ", "matrices", 
     " ", 
     RowBox[{
      RowBox[{"VMat", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", " ", "They"}], " ", "are", " ", 
     "similar", " ", "to", " ", "matrix", " ", "MatB"}], ",", " ", 
    RowBox[{"with", " ", "the", " ", 
     RowBox[{"i", "^", "th"}], " ", "column", " ", "replaced", " ", "by", " ",
      "the", " ", 
     RowBox[{"i", "^", "th"}], " ", "column", " ", "of", " ", "matrix", " ", 
     "MatA"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.716741319308914*^9, 3.7167416026411963`*^9}, {
  3.716741744038208*^9, 3.7167417531820345`*^9}, {3.716741984012439*^9, 
  3.716742103629557*^9}, {3.716742247665967*^9, 3.7167423005239224`*^9}, {
  3.718374783239609*^9, 3.7183747969455013`*^9}, {3.7203635884085383`*^9, 
  3.7203637089499874`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fA", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Simul", "@@", 
       RowBox[{"MatA", "[", 
        RowBox[{"[", "it3", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"it3", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming", 
  RowBox[{"(*", 
   RowBox[{"Vector", " ", "A", " ", 
    RowBox[{"generation", ".", " ", "We"}], " ", "use", " ", "the", " ", 
    "input", " ", "matrix", " ", "MatA", " ", "and", " ", "calculate", " ", 
    "the", " ", "option", " ", "price", " ", "using", " ", "all", " ", "the", 
    " ", "input", " ", "parameters", " ", "on", " ", "each", " ", "row"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7184383168247714`*^9, 3.7184383206353483`*^9}, {
  3.7184384376030874`*^9, 3.7184384823417873`*^9}, {3.7184392084423685`*^9, 
  3.7184392676507263`*^9}, {3.7184532316895504`*^9, 3.718453275213601*^9}, {
  3.7203638633764715`*^9, 3.7203639168534527`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8283993018517565`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.718438447889184*^9, 3.718438484999781*^9}, 
   3.718438676112556*^9, 3.7184388065993166`*^9, {3.7184390012328777`*^9, 
   3.7184392747480745`*^9}, 3.718439400679226*^9, 3.7184484690786953`*^9, 
   3.7184501673757935`*^9, {3.718451992784627*^9, 3.718452038275092*^9}, 
   3.718452490576316*^9, 3.7184526160145235`*^9, {3.718452740979125*^9, 
   3.718452832442748*^9}, {3.7184532238901005`*^9, 3.7184532415349474`*^9}, 
   3.7184557149280243`*^9, 3.718466565280772*^9, 3.718479495642575*^9, 
   3.7185316005436926`*^9, 3.7185333142254744`*^9, 3.718533775101752*^9, 
   3.718577996937747*^9, 3.718814825047493*^9, 3.718929242332383*^9, 
   3.719910087602061*^9, 3.720086079214893*^9, 3.7200920348148212`*^9, {
   3.720364274091738*^9, 3.720364302051809*^9}, 3.7203644496117096`*^9, 
   3.720364499556562*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fB", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Simul", "@@", 
       RowBox[{"MatB", "[", 
        RowBox[{"[", "it4", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"it4", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Vector", " ", "B", " ", 
    RowBox[{"generation", "."}]}], "*)"}]}]], "Input",
 CellChangeTimes->{
  3.718438495353545*^9, {3.718439236398389*^9, 3.7184392700787406`*^9}, {
   3.718453278140724*^9, 3.718453287466115*^9}, 3.7203638444683547`*^9, {
   3.720363982113291*^9, 3.72036399257937*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"it2", "=", "1"}], ";", 
        RowBox[{"fVA", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"it2", "<=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "VMat", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"it2", "++"}], ",", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"Simul", "@@", 
            RowBox[{"VMat", "[", 
             RowBox[{"[", 
              RowBox[{"it2", ",", "it1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"it1", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"fVA", ",", "tmp"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"it2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "VMat", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Vectors", " ", 
    RowBox[{"fVA", "[", 
     RowBox[{"[", "i", "]"}], "]"}], " ", 
    RowBox[{"generation", ".", " ", "The"}], " ", "inputs", " ", "used", " ", 
    "were", " ", "the", " ", "matrices", " ", 
    RowBox[{
     RowBox[{"VMat", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "."}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7167304071822057`*^9, 3.716730535381955*^9}, 
   3.716730937149556*^9, {3.7167315751778173`*^9, 3.7167315926262946`*^9}, {
   3.7167412907761626`*^9, 3.7167412977677903`*^9}, {3.716742010550888*^9, 
   3.7167420136977572`*^9}, {3.7167422412984343`*^9, 
   3.7167422433542843`*^9}, {3.7167424173192153`*^9, 
   3.7167426115563025`*^9}, {3.7167427217742634`*^9, 3.716743027339649*^9}, {
   3.7167431354463835`*^9, 3.716743294240864*^9}, {3.7167434634573946`*^9, 
   3.7167436093492393`*^9}, {3.7177859748494864`*^9, 
   3.7177859753398066`*^9}, {3.7183748108448615`*^9, 3.718374813031918*^9}, {
   3.718375186364918*^9, 3.718375200945133*^9}, {3.7184002448723907`*^9, 
   3.7184002642257843`*^9}, {3.7184382602745557`*^9, 3.718438312472669*^9}, {
   3.718438498175537*^9, 3.71843865063345*^9}, {3.7184387575291805`*^9, 
   3.7184391962354975`*^9}, {3.718453293234694*^9, 3.7184533110945306`*^9}, 
   3.7203638391711454`*^9, {3.7203640012330656`*^9, 3.7203640429272337`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "=", "1"}], ";", 
     RowBox[{"Vi", "=", 
      RowBox[{"{", "}"}]}]}], ",", 
    RowBox[{"x", "\[LessEqual]", 
     RowBox[{
      RowBox[{"Dimensions", "[", "fVA", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"x", "++"}], ",", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"1", "/", "Num"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"fA", "[", 
           RowBox[{"[", "w", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"fVA", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", "w"}], "]"}], "]"}], "-", 
            RowBox[{"fB", "[", 
             RowBox[{"[", "w", "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"w", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"Vi", ",", "tmp"}], "]"}]}]}], "]"}], " ", ";", "Vi", 
  RowBox[{"(*", 
   RowBox[{
   "Contribution", " ", "of", " ", "each", " ", "variable", " ", "to", " ", 
    "the", " ", "final", " ", 
    RowBox[{"variance", ".", " ", "The"}], " ", "output", " ", "is", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", ",", "sigma", ",", "S0"}], ")"}], "."}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7183903580934005`*^9, 3.718390535041298*^9}, {
  3.7184314637806377`*^9, 3.7184314673666716`*^9}, {3.720364048981085*^9, 
  3.7203642004096084`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.007826192935466865`"}], ",", 
   RowBox[{"-", "0.003967118872981445`"}], ",", "0.0010117412612052734`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7203642881640224`*^9, 3.7203643023526382`*^9}, 
   3.720364452931049*^9, 3.720364502419321*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BarChart", "[", 
  RowBox[{
   RowBox[{"Vi", "/", 
    RowBox[{"Total", "[", 
     RowBox[{"Vi", ",", "2"}], "]"}]}], ",", 
   RowBox[{"ChartLabels", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<\[Sigma]\>\"", ",", "\"\<S0\>\""}], 
     "}"}]}], ",", 
   RowBox[{"LabelingFunction", "\[Rule]", "Above"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.719074131620195*^9, 3.71907414940376*^9}, {
  3.719074325102871*^9, 3.719074360430854*^9}, {3.7190744780830536`*^9, 
  3.7190745796184444`*^9}, {3.7203640875551305`*^9, 3.72036409070266*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {Opacity[0], PointBox[{0.48597994530537825`, 0}]}, {{}, 
    {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
     0.6789999999999999], Thickness[Small]}], 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6789999999999999], Thickness[Small]}], 
      DynamicBox[{
        FEPrivate`If[
         CurrentValue["MouseOver"], 
         EdgeForm[{
           GrayLevel[0.5], 
           AbsoluteThickness[1.5], 
           Opacity[0.66]}], {}, {}], 
        RectangleBox[{0.544211485870556, 0.}, {1.455788514129444, 
         0.725886168547875}, "RoundingRadius" -> 0]},
       ImageSizeCache->{{24.17139208624627, 
        125.19412355534874`}, {-97.24999999999999, 74.63900558467434}}]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6789999999999999], Thickness[Small]}], 
      DynamicBox[{
        FEPrivate`If[
         CurrentValue["MouseOver"], 
         EdgeForm[{
           GrayLevel[0.5], 
           AbsoluteThickness[1.5], 
           Opacity[0.66]}], {}, {}], 
        RectangleBox[{1.544211485870556, 0.}, {2.455788514129444, 
         0.3679537091185551}, "RoundingRadius" -> 0]},
       ImageSizeCache->{{134.44482850785167`, 
        235.4675599769541}, {-12.73855599385628, 74.63900558467434}}]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6789999999999999], Thickness[Small]}], 
      DynamicBox[{
        FEPrivate`If[
         CurrentValue["MouseOver"], 
         EdgeForm[{
           GrayLevel[0.5], 
           AbsoluteThickness[1.5], 
           Opacity[0.66]}], {}, {}], 
        RectangleBox[{2.544211485870556, 0.}, {
         3.455788514129444, -0.09383987766643019}, "RoundingRadius" -> 0]},
       ImageSizeCache->{{244.71826492945704`, 345.74099639855945`}, {
        74.13900558467434, 96.79554198708439}}]}}, {}, {}}, {}, {
    InsetBox["0.725886168547875`", Offset[{0, 4}, {1., 0.725886168547875}], 
     ImageScaled[{0.5, 0}]], 
    InsetBox["0.3679537091185551`", Offset[{0, 4}, {2., 0.3679537091185551}], 
     ImageScaled[{0.5, 0}]], InsetBox[
     RowBox[{"-", "0.09383987766643019`"}], Offset[{0, 4}, {3., 0.}], 
     ImageScaled[{0.5, 0}]]}, 
   StyleBox[{
     {Thickness[Tiny], 
      LineBox[{{0.48597994530537825`, 0.}, {3.5151846855059254`, 0.}}], 
      StyleBox[{}, "GraphicsLabel",
       StripOnInput->False]}, 
     StyleBox[{
       {Thickness[Tiny], 
        LineBox[{{0.544211485870556, 0.}, 
          Offset[{-1.102182119232618*^-15, -6.}, {0.544211485870556, 0.}]}], 
        LineBox[{{3.455788514129444, 0.}, 
          Offset[{-1.102182119232618*^-15, -6.}, {3.455788514129444, 
           0.}]}], {{}, {}, {}, {
          LineBox[{{1.455788514129444, 0.}, 
            Offset[{-7.347880794884119*^-16, -4.}, {1.455788514129444, 0.}]}],
           LineBox[{{1.544211485870556, 0.}, 
            Offset[{-7.347880794884119*^-16, -4.}, {1.544211485870556, 0.}]}],
           LineBox[{{2.455788514129444, 0.}, 
            Offset[{-7.347880794884119*^-16, -4.}, {2.455788514129444, 0.}]}],
           LineBox[{{2.544211485870556, 0.}, 
            Offset[{-7.347880794884119*^-16, -4.}, {2.544211485870556, 
             0.}]}]}, {}}}, 
       StyleBox[
        {Thickness[Tiny], 
         InsetBox["\<\"r\"\>", Offset[{0., -2.}, {1., 0.}], {0, 1}, 
          Automatic, {1, 0}], 
         InsetBox["\<\"\[Sigma]\"\>", Offset[{0., -2.}, {2., 0.}], {0, 1}, 
          Automatic, {1, 0}], 
         InsetBox["\<\"S0\"\>", Offset[{0., -2.}, {3., 0.}], {0, 1}, 
          Automatic, {1, 0}]}, "GraphicsLabel",
        StripOnInput->False]}, "GraphicsTicks",
      StripOnInput->False]}, "GraphicsAxes",
    StripOnInput->False,
    Antialiasing->False]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.48597994530537825`, 0},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& )},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {{{1., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {1., 
       FormBox["\"r\"", TraditionalForm], 0}, {2., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {2., 
       FormBox["\"\[Sigma]\"", TraditionalForm], 0}, {3., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {3., 
       FormBox["\"S0\"", TraditionalForm], 0}}, {{1., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {2., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}, {3., 
       FormBox[
        InterpretationBox[
         StyleBox[
          GraphicsBox[{}, ImageSize -> {0, 0}, BaselinePosition -> Baseline], 
          "CacheGraphics" -> False], 
         Spacer[0]], TraditionalForm], {0.004, 0}}}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotRange->{{All, All}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{None, Automatic}]], "Output",
 CellChangeTimes->{
  3.719074151016547*^9, {3.7190743417051697`*^9, 3.7190743611227007`*^9}, {
   3.719074485809703*^9, 3.719074579962562*^9}, 3.7201160277550335`*^9, {
   3.720364292167577*^9, 3.7203643025063257`*^9}, 3.7203644531313553`*^9, 
   3.7203645025573044`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"MatRand1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"MatRand2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], "]"}], 
   ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Sigma]\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7188852534919825`*^9, 3.718885758674271*^9}, {
  3.7188858912494326`*^9, 3.718885901327745*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAsrD3cuFPyT+pMlQ+2j34PyignZOh
3Mk/k2y8Yh0sAECqoDaA9RnKP2lNjokPMfo/9mfarZjgyD8mlMKTYr8AQMps
M/eSUco/5CVdCx1I+j8bsiVuUDbJP24jWQYzgPc/ch/RyEA0yj8qkTZedST2
P5y7pthWG8o/RSfR5NmSAUAxc8hNfVLHPzN3Wm288Os/6auPql1FyD9mZiPX
ehfzP8cHqA6bU8o/u2quT7um9D+zVVEOhsjGP07GS40aw+c/OujDSXmzyD8B
1AYChpr3P8f6R99IsMk/p+o2f0dm9D9dMVVe2NrKP6cwHvMNKvY/PUTralN+
yT9f/k+EXdb3PyIXv/duOsg/yV8u0jy/9z/7h+dxpCjKP1hf9tg+bvk/g/ys
BDWpyD/G8e7xFq7yP9uum5Z5T8o/hThEHWR3+D9zlKAl
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"\[Sigma]\"", TraditionalForm], 
    FormBox["\"option price\"", TraditionalForm]},
  AxesOrigin->{0.17749747869906873`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0.1779944963370049, 0.20980362516491882`}, {
    0, 2.1967046619728614`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7188853607617073`*^9, 3.7188857590972066`*^9}, {
   3.7188859019403324`*^9, 3.7188859555880527`*^9}, 3.719058893937584*^9, 
   3.720097992778202*^9, {3.720364293687042*^9, 3.7203643026534805`*^9}, 
   3.720364453247262*^9, 3.7203645026575804`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"MatRand1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"MatRand2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], "]"}], 
   ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.718885657814292*^9, 3.718885657970828*^9}, {
  3.7188857741501493`*^9, 3.71888578029749*^9}, {3.7188859283059716`*^9, 
  3.7188859470862336`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAdA+qCQ7crj+pMlQ+2j34P67YHTnj
3q0/k2y8Yh0sAEBvabRxRtOuP2lNjokPMfo/1MxQHWOirT8mlMKTYr8AQLf3
6BeToq0/5CVdCx1I+j+x8sOnkuSuP24jWQYzgPc/k5DeUfxerj8qkTZedST2
P4hP7sJKs64/RSfR5NmSAUCvo07tnnGvPzN3Wm288Os/+VYOmoMCrj9mZiPX
ehfzP4+9++caRK8/u2quT7um9D8nYNjlInCvP07GS40aw+c/1qgzMrS+rz8B
1AYChpr3P0yhKdL5l64/p+o2f0dm9D9cJ86bBCuuP6cwHvMNKvY/pglEwizA
rj9f/k+EXdb3P7xJcLSxRK4/yV8u0jy/9z8ERfho0ZGuP1hf9tg+bvk/yYJr
k09krz/G8e7xFq7yPyggL+fpdK4/hThEHWR3+D8sdZ7G
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"r\"", TraditionalForm], 
    FormBox["\"option price\"", TraditionalForm]},
  AxesOrigin->{0.05781512998385344, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0.05787954075676685, 0.062001830223225404`}, {
    0, 2.1967046619728614`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.7188856590994215`*^9, {3.718885782096718*^9, 3.7188858194508357`*^9}, 
   3.718885957470745*^9, 3.719058893990512*^9, 3.720097992831637*^9, {
   3.7203642943260856`*^9, 3.7203643028918114`*^9}, 3.720364453327902*^9, 
   3.720364502757861*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"MatRand1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"MatRand2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], "]"}], 
   ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<S0\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7188858119976788`*^9, 3.71888581667787*^9}, {
  3.718885934283245*^9, 3.7188859419037714`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAQbJB6y30RUCpMlQ+2j34P3/HgT+U
DkZAk2y8Yh0sAEAYevzkk/VFQGlNjokPMfo/BSZLeN32RUAmlMKTYr8AQJUB
X0VN/kVA5CVdCx1I+j9NsRWerQFGQG4jWQYzgPc/ZFKyfqvqRUAqkTZedST2
PwzesCTp8EVARSfR5NmSAUCINYv6CxdGQDN3Wm288Os/zvPCksQbRkBmZiPX
ehfzP3zGQtk5AUZAu2quT7um9D8NATzuOv1FQE7GS40aw+c/yWj9mh73RUAB
1AYChpr3P0mzGHvo/EVAp+o2f0dm9D/P0yLbrfdFQKcwHvMNKvY/KTRsldwI
RkBf/k+EXdb3P2rh9Wn75UVAyV8u0jy/9z9F57tshwlGQFhf9tg+bvk/W6/p
YyvnRUDG8e7xFq7yP74RKqpt/0VAhThEHWR3+D8Sz5b9
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"S0\"", TraditionalForm], 
    FormBox["\"option price\"", TraditionalForm]},
  AxesOrigin->{43.79016939675262, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{43.79673504358182, 44.21693644065054}, {
    0, 2.1967046619728614`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.718885817166256*^9, 3.7188859607075624`*^9, 3.7190588940219717`*^9, 
   3.720097992878544*^9, {3.7203642943885927`*^9, 3.720364302969948*^9}, 
   3.7203644533944163`*^9, 3.7203645028581333`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "If", " ", "the", " ", "variable", " ", "Exporting", " ", "was", " ", 
     "set", " ", "to", " ", "True"}], ",", " ", 
    RowBox[{"export", " ", "the", " ", 
     RowBox[{"results", ".", " ", "This"}], " ", "might", " ", "be", " ", 
     "useful", " ", "to", " ", "avoid", " ", "repeating", " ", "lengthy", " ", 
     RowBox[{"computations", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"Exporting", ",", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\MatA5.m\>\"", ",", "MatA"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\MatB5.m\>\"", ",", "MatB"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\fA5.m\>\"", ",", "fA"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\fB5.m\>\"", ",", "fB"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\fVA5.m\>\"", ",", "fVA"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Matrices\\\\Param5.m\>\"", ",", 
         RowBox[{"Param", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ","}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"Exporting", ",", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Images\\\\sigma5.eps\>\"", ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"MatRand1", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"MatRand2", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Sigma]\>\"", ",", "\"\<option price\>\""}], 
             "}"}]}]}], "]"}], ",", "\"\<eps\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Images\\\\r5.eps\>\"", ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"MatRand1", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"MatRand2", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<r\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<C:\\\\Users\\\\Miguel Ribeiro\\\\Documents\\\\GitHub\\\\Thesis\\\
\\Images\\\\S05.eps\>\"", ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"MatRand1", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
                 RowBox[{"MatRand2", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{"fA", ",", "fB"}], "]"}], "}"}], ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<S0\>\"", ",", "\"\<option price\>\""}], "}"}]}]}], 
          "]"}], ",", "\"\<eps\>\""}], "]"}]}], ","}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7190746265386105`*^9, 3.719074835142562*^9}, {
   3.719075729672616*^9, 3.7190758646329126`*^9}, {3.7197461396649895`*^9, 
   3.719746144930312*^9}, {3.7199249657148294`*^9, 3.719925062283516*^9}, 
   3.7200068135298133`*^9, {3.7203616753344975`*^9, 3.720361684270068*^9}, {
   3.720365303290278*^9, 3.7203653035440807`*^9}, {3.7203670989672256`*^9, 
   3.7203671001247444`*^9}}],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"]
},
WindowSize->{681, 676},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2567, 60, 272, "Input"],
Cell[3150, 84, 183, 4, 31, "Output"]
}, Open  ]],
Cell[3348, 91, 245, 6, 43, "Text"],
Cell[3596, 99, 7262, 149, 612, "Input"],
Cell[10861, 250, 256, 6, 43, "Text"],
Cell[11120, 258, 3081, 66, 332, "Input"],
Cell[14204, 326, 251, 6, 43, "Text"],
Cell[14458, 334, 1107, 25, 92, "Input"],
Cell[15568, 361, 751, 15, 52, "Input"],
Cell[16322, 378, 1342, 29, 112, "Input"],
Cell[17667, 409, 735, 18, 52, "Input"],
Cell[18405, 429, 1707, 34, 152, "Input"],
Cell[20115, 465, 1743, 46, 172, "Input"],
Cell[CellGroupData[{
Cell[21883, 515, 994, 22, 92, "Input"],
Cell[22880, 539, 922, 14, 31, "Output"]
}, Open  ]],
Cell[23817, 556, 632, 17, 52, "Input"],
Cell[24452, 575, 2499, 57, 152, "Input"],
Cell[CellGroupData[{
Cell[26976, 636, 1537, 44, 132, "Input"],
Cell[28516, 682, 303, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28856, 694, 582, 13, 52, "Input"],
Cell[29441, 709, 6341, 151, 238, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35819, 865, 839, 24, 72, "Input"],
Cell[36661, 891, 1719, 39, 243, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38417, 935, 882, 25, 72, "Input"],
Cell[39302, 962, 1710, 40, 245, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41049, 1007, 832, 24, 72, "Input"],
Cell[41884, 1033, 1655, 39, 240, "Output"]
}, Open  ]],
Cell[43554, 1075, 5662, 135, 912, "Input"],
Cell[49219, 1212, 60, 1, 31, "Input"]
}
]
*)

